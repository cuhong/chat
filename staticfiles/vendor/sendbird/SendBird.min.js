/**
 * Copyright (c) 2016 SendBird DBA (Smile Family, Inc.)
 * SendBird JavaScript SDK v3.0.77
 */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.SendBird=n():e.SendBird=n()}("undefined"!=typeof self?self:this,function(){function e(){this.oldIE=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}var n,t=!1,r="wss://ws.sendbird.com",i="https://api.sendbird.com",a=1e3,s=9e3;try{n=window.console||{log:function(){}}}catch(e){n={log:function(){}}}var o="undefined";try{o=navigator.userAgent.replace(/,/g,".")}catch(e){o="undefined"}var l,u="JS,"+o+",3.0.77,",c=function(){try{if(document&&9===document.documentMode)return!0}catch(e){return!1}return!1}(),d=function(){try{if(document&&document.documentMode<=8)return!0}catch(e){return!1}return!1}();if(c||d)"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"function"!=typeof Array.prototype.forEach&&(Array.prototype.forEach=function(e){for(var n=0;n<this.length;n++)e.apply(this,[this[n],n,this])}),e.prototype.append=function(e,n){this._fields.push([e,n])},e.prototype.toString=function(){var e=this.boundary,n="";return this._fields.forEach(function(t){if(n+="--"+e+"\r\n",t[1].name){var r=t[1];n+='Content-Disposition: form-data; name="'+t[0]+'"; filename="'+r.name+'"\r\n',n+="Content-Transfer-Encoding: base64\r\n",n+="Content-Type: "+r.type+"\r\n\r\n",n+=r.base64+"\r\n"}else n+='Content-Disposition: form-data; name="'+t[0]+'";\r\n\r\n',n+=t[1]+"\r\n"}),n+="--"+e+"--"},l=e;else if("undefined"==typeof window&&"undefined"==typeof FormData)try{l=require("form-data")}catch(e){}var h=function(e,n,t){if(t&&"function"==typeof t)if(e){var r=null;try{r=JSON.parse(e.response)}catch(e){}var i=r?r.message:null,a=r?r.code:null;t(n,new I(i,a))}else t(n,null)},p=function(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return Array.isArray(e)?JSON.stringify(e)===JSON.stringify([]):JSON.stringify(e)===JSON.stringify({})},_=function(e){try{if("number"==typeof e)return!0;if("string"==typeof e){return/^\d+$/.test(e)}}catch(e){return t&&n.error(e),!1}},f=function(){var e=function(){};return function(n,t){e.prototype=new n,t.prototype=new e,t["super"]=n.prototype,t.prototype.constructor=t}}(),I=function(e,n){return this.name="SendBirdException",this.code=n||0,this.message=e,this};f(Error,I);var E={MessageTypeFilter:{ALL:0,USER:1,FILE:2,ADMIN:3}},g=function(e){return Object.keys(e).forEach(function(n){null!==e[n]&&"undefined"!=typeof e[n]&&"object"==typeof e[n]&&(e[n]=g(e[n]))}),Object.freeze(e)},m=function(e){return JSON.parse(JSON.stringify(e))},A=function(e,n,t){try{"number"==typeof n&&n>=0&&("all"===e.myCountPreference||"unread_message_count_only"===e.myCountPreference?e.isSuper?e.unreadMessageCount=n>=1?1:0:e.unreadMessageCount=n:e.unreadMessageCount=0),"number"==typeof t&&t>=0&&("all"===e.myCountPreference||"unread_mention_count_only"===e.myCountPreference?e.unreadMentionCount=t:e.unreadMentionCount=0)}catch(e){}},v=function(){var e,c=function(){var e=function(){try{navigator.onLine&&(Ee.getInstance().reconnecting||Ee.getInstance().connecting||!le.getInstance().sessionKey||Ee.getInstance().getConnectionState()===Ee.getInstance().ConnectionState.OPEN||Ee.getInstance().reconnect())}catch(e){t&&n.log("There is no window.addEventListener.ononline or navigator.onLine")}},r=function(){try{navigator.onLine||Ee.getInstance().reconnecting||Ee.getInstance().connecting||!le.getInstance().sessionKey||(se&&se.stop(),Ee.getInstance().reconnect())}catch(e){t&&n.log("There is no window.addEventListener.ononline or navigator.onLine")}};this.start=function(){try{window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&navigator&&"boolean"==typeof navigator.onLine&&(window.addEventListener("online",e),window.addEventListener("offline",r))}catch(e){t&&n.log("There is no window.addEventListener.ononline or navigator.onLine")}},this.stop=function(){try{window.removeEventListener("online",e,!1),window.removeEventListener("offline",r,!1)}catch(e){t&&n.log("There is no window.addEventListener.ononline or navigator.onLine")}}},v=new c,C={};try{e="undefined"==typeof window?require("xhr2"):null}catch(n){e=null}if(e)try{var N=require("agentkeepalive"),y=require("agentkeepalive").HttpsAgent,R=new N({keepAlive:!0,timeout:6e4,keepAliveTimeout:6e4});C.httpAgent=R;var U=new y({keepAlive:!0,timeout:6e4,keepAliveTimeout:6e4});C.httpsAgent=U}catch(e){}var S=function(){var n;return e?(n=new e,n.nodejsSet(C)):n=new XMLHttpRequest,n},T=function(e,r,i,a,s){var o=S();o.open(i,e),o.onload=function(){if(o.status>=200&&o.status<400){var e=!1,n=null;try{n=JSON.parse(o.responseText)}catch(n){e=!0}e?h(new I("Request failed.",te.REQUEST_FAILED),null,s):h(null,n,s)}else h({status:o.status,statusText:o.statusText,response:o.responseText},null,s)},o.onerror=function(){h({status:404,statusText:"There was a connection error",response:JSON.stringify({message:"There was a connection error",code:te.NETWORK_ERROR})},null,s)};try{for(var u in a)o.setRequestHeader(u,a[u]?a[u]:"sendbird")}catch(e){}try{switch(i){case"get":case"GET":o.send();break;default:"undefined"!=typeof FormData&&FormData&&r instanceof FormData||void 0!==l&&l&&r instanceof l?r.oldIE?(o.setRequestHeader("Content-Type","multipart/form-data; boundary="+r.boundary),o.send(r.toString())):o.send(r):(o.setRequestHeader("Content-Type","application/json; charset=utf-8"),o.send(JSON.stringify(r)))}}catch(e){t&&n.log("request.send() fail: ",e)}},P=!1,O=function(e,n,t){t&&"function"==typeof t&&(void 0===n&&(n=null),void 0===e&&(e=null),P?t(n,e):t(e,n))},L="",M=0,D=0,b=function(e){this.isOpenChannel=function(){return this.channelType===k.CHANNEL_TYPE_OPEN},this.isGroupChannel=function(){return this.channelType===k.CHANNEL_TYPE_GROUP},this.isUserMessage=function(){return this.messageType===b.MESSAGE_TYPE_USER},this.isAdminMessage=function(){return this.messageType===b.MESSAGE_TYPE_ADMIN},this.isFileMessage=function(){return this.messageType===b.MESSAGE_TYPE_FILE},this._update=function(e){this.messageId=e.hasOwnProperty("msg_id")?parseInt(e.msg_id):0,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):k.CHANNEL_TYPE_GROUP,this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:pe.MentionType.USERS;var n=this;if(n.mentionedUsers=[],e.hasOwnProperty("mentioned_users")){e.mentioned_users.forEach(function(e){var t=new W(e);n.mentionedUsers.push(t)})}},this.serialize=function(){var e=JSON.parse(JSON.stringify(this));return e.hasOwnProperty("_sender")&&(e.sender=e._sender,delete e._sender),g(e)},this.messageType=b.MESSAGE_TYPE_BASE,e&&this._update(e)};b.build=function(e,n){if(!e)return null;var t,r,i,a,s,o,l,u,c,d;switch(e.type){case"MESG":return t=new W(e.user),r=parseInt(e.message_id),i=String(e.message),a=String(e.data),s=parseInt(e.created_at),o=parseInt(e.updated_at),l=e.hasOwnProperty("custom_type")?String(e.custom_type):"",u=e.hasOwnProperty("translations")?e.translations:{},c=e.hasOwnProperty("mention_type")?e.mention_type:pe.MentionType.USERS,d=e.mentioned_users,new w(w.build("",r,t,n,i,a,l,u,s,o,c,d));case"FILE":t=new W(e.user),r=parseInt(e.message_id),i=String(e.message),s=parseInt(e.created_at),o=parseInt(e.updated_at),l=e.hasOwnProperty("custom_type")?String(e.custom_type):"",c=e.hasOwnProperty("mention_type")?e.mention_type:pe.MentionType.USERS,d=e.mentioned_users;var h=e.file,p=String(h.url),_=String(h.name),f=String(h.type),I=parseInt(h.size)||0;a=String(h.data);var E=e.hasOwnProperty("thumbnails")?e.thumbnails:[],g=!!e.hasOwnProperty("require_auth")&&e.require_auth;return new F(F.build("",r,t,n,p,_,f,I,a,l,s,E,g,o,c,d));case"BRDM":case"ADMM":return r=parseInt(e.message_id),i=String(e.message),a=String(e.data),s=parseInt(e.created_at),o=parseInt(e.updated_at),l=e.hasOwnProperty("custom_type")?String(e.custom_type):"",u=e.hasOwnProperty("translations")?e.translations:{},c=e.hasOwnProperty("mention_type")?e.mention_type:pe.MentionType.USERS,d=e.mentioned_users,new H(H.build(r,n,i,a,l,u,s,o,c,d))}return null},b.MESSAGE_TYPE_BASE="base",b.MESSAGE_TYPE_ADMIN="admin",b.MESSAGE_TYPE_USER="user",b.MESSAGE_TYPE_FILE="file";var H=function(e){this.messageType=b.MESSAGE_TYPE_ADMIN,e&&(this._update(e),this.message=String(e.message),this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.translations=e.hasOwnProperty("translations")?e.translations:{})};f(b,H),H.build=function(e,n,t,r,i,a,s,o,l,u){var c={msg_id:e,channel_url:n.url,channel_type:n.channelType===k.CHANNEL_TYPE_OPEN?k.CHANNEL_TYPE_OPEN:k.CHANNEL_TYPE_GROUP,ts:s,updated_at:o,message:t,data:r};return i&&(c.custom_type=i),a&&(c.translations=a),l&&(c.mention_type=l),c.mentioned_users=[],u&&(c.mentioned_users=u),c},H.buildFromSerializedData=function(e){var n=m(e),t=[];return n.mentionedUsers.forEach(function(e){t.push(W.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName))}),new H(H.build(n.messageId,{url:n.channelUrl,channelType:n.channelType},n.message,n.data,n.customType,n.translations,n.createdAt,n.updatedAt,n.mentionType,t))};var w=function(e){this.messageType=b.MESSAGE_TYPE_USER,e&&(this._update(e),this.message=String(e.message),this.data=e.hasOwnProperty("data")?String(e.data):"",this._sender=new W(e.user),d?this.sender=this._sender:Object.defineProperty(this,"sender",{get:function(){if(Ee.getInstance().Options.useMemberAsMessageSender&&this.isGroupChannel()){var e=Y.cachedChannels[this.channelUrl];if(e){var n=e.memberMap[this._sender.userId];n&&(this._sender.nickname!==n.nickname&&(this._sender.nickname=n.nickname),this._sender.profileUrl!==n.profileUrl&&(this._sender.profileUrl=n.profileUrl),this._sender.metaData!==n.metaData&&(this._sender.metaData=n.metaData))}}return this._sender},set:function(e){this._sender=e}}),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.translations=e.hasOwnProperty("translations")?e.translations:{})};f(b,w),w.build=function(e,n,t,r,i,a,s,o,l,u,c,d,h){var p={};p.req_id=e,p.msg_id=n,p.channel_url=r.url,p.channel_type=r.channelType===k.CHANNEL_TYPE_OPEN?k.CHANNEL_TYPE_OPEN:k.CHANNEL_TYPE_GROUP,p.ts=l,p.updated_at=u,p.message=i,a&&(p.data=a),s&&(p.custom_type=s),o&&(p.translations=o);var _={user_id:"",nickname:"",profile_url:"",metadata:{}};if(t){_.user_id=t.userId,_.nickname=t.nickname,_.profile_url=t.profileUrl;try{_.metadata="string"==typeof t.metaData?JSON.parse(t.metaData):t.metaData}catch(e){_.metadata={}}}return p.user=_,p.mention_type=pe.MentionType.USERS,c&&(p.mention_type=c),p.mentioned_users=[],d&&(p.mentioned_users=d),h&&(p.mentioned_user_ids=h),p},w.buildFromSerializedData=function(e){var n=m(e),t=[];return n.mentionedUsers.forEach(function(e){t.push(W.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName))}),new w(w.build(n.reqId,n.messageId,n.sender,{url:n.channelUrl,channelType:n.channelType},n.message,n.data,n.customType,n.translations,n.createdAt,n.updatedAt,n.mentionType,t))};var F=function(e){if(this.messageType=b.MESSAGE_TYPE_FILE,e&&(this._update(e),this._sender=new W(e.user),d?this.sender=this._sender:Object.defineProperty(this,"sender",{get:function(){if(Ee.getInstance().Options.useMemberAsMessageSender&&this.isGroupChannel()){var e=Y.cachedChannels[this.channelUrl];if(e){var n=e.memberMap[this._sender.userId];n&&(this._sender.nickname!==n.nickname&&(this._sender.nickname=n.nickname),this._sender.profileUrl!==n.profileUrl&&(this._sender.profileUrl=n.profileUrl),this._sender.metaData!==n.metaData&&(this._sender.metaData=n.metaData))}}return this._sender},set:function(e){this._sender=e}}),this.requireAuth=!!e.hasOwnProperty("require_auth")&&e.require_auth,this.url=this.requireAuth?String(e.url).split("?auth=")[0]+"?auth="+le.getInstance().ekey:String(e.url).split("?auth=")[0],this.name=e.hasOwnProperty("name")?e.name:"File",this.size=parseInt(e.size)||0,this.type=String(e.type),this.data=e.hasOwnProperty("custom")?String(e.custom):"",this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.thumbnails=e.hasOwnProperty("thumbnails")?e.thumbnails:[],this.requireAuth))for(var n in this.thumbnails)this.thumbnails[n].url=String(this.thumbnails[n].url).split("?auth=")[0]+"?auth="+le.getInstance().ekey};f(b,F),F.build=function(e,n,t,r,i,a,s,o,l,u,c,d,h,p,_,f,I){var E={};E.req_id=e,E.msg_id=n,E.channel_url=r.url,E.channel_type=r.channelType===k.CHANNEL_TYPE_OPEN?k.CHANNEL_TYPE_OPEN:k.CHANNEL_TYPE_GROUP,E.ts=c,E.updated_at=p,E.url=i,E.name=a,E.type=s,E.size=o,E.custom=l;var g={user_id:"",nickname:"",profile_url:"",metadata:{}};if(t){g.user_id=t.userId,g.nickname=t.nickname,g.profile_url=t.profileUrl;try{g.metadata=JSON.parse(t.metaData)}catch(e){g.metadata={}}}return E.user=g,u&&(E.custom_type=u),h&&(E.require_auth=h),d&&(E.thumbnails=d),_&&(E.mention_type=_),E.mentioned_users=[],f&&(E.mentioned_users=f),I&&(E.mentioned_user_ids=I),E},F.buildFromSerializedData=function(e){var n=m(e),t=[];return n.mentionedUsers.forEach(function(e){t.push(W.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName))}),new F(F.build(n.reqId,n.messageId,n.sender,{url:n.channelUrl,channelType:n.channelType},n.url,n.name,n.type,n.size,n.data,n.customType,n.createdAt,n.thumbnails,n.requireAuth,n.updatedAt,n.mentionType,t))};var k=function(e){this._update=function(e){this.url=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.name=e.hasOwnProperty("name")?String(e.name):"",this.coverUrl=e.hasOwnProperty("cover_url")?String(e.cover_url):"",this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?e.custom_type:"",this.isFrozen=!!e.hasOwnProperty("freeze")&&e.freeze,this.isEphemeral=!!e.hasOwnProperty("is_ephemeral")&&e.is_ephemeral,this.fileUploadRequest={}},this.serialize=function(){var e=JSON.parse(JSON.stringify(this));if(e.hasOwnProperty("lastMessage")&&null!==e.lastMessage&&"undefined"!=typeof e.lastMessage&&"object"==typeof e.lastMessage){var n=e.lastMessage;n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender,e.lastMessage=n)}return g(e)},this.isGroupChannel=function(){return this.channelType===k.CHANNEL_TYPE_GROUP},this.isOpenChannel=function(){return this.channelType===k.CHANNEL_TYPE_OPEN},this.getMessageChangeLogsByToken=function(e,n){if("function"==typeof e&&(n=e,e=null),"function"!=typeof n)return null;le.getInstance().getMessageChangeLogsByToken(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);var r=e.updated.map(function(e){return b.build(e,this)}),i=e.deleted.map(function(e){return e.message_id}),a=e.has_more,s=e.next;O({updatedMessages:r,deletedMessageIds:i,hasMore:a,token:s},null,n)})},this.createOperatorListQuery=function(){return new z(this)},this.createPreviousMessageListQuery=function(){return new ee(this)},this.createMessageListQuery=function(){return new X(this)};var n=function(e,n,t,r,i,a,s,o,l,u){if(s===E.MessageTypeFilter.ADMIN?s="ADMM":s===E.MessageTypeFilter.USER?s="MESG":s===E.MessageTypeFilter.FILE?s="FILE":s===E.MessageTypeFilter.ALL&&(s=""),!(_(n)&&"boolean"==typeof t&&_(r)&&_(i)&&"boolean"==typeof a&&"string"==typeof s&&"string"==typeof o&&Array.isArray(l)))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),u);for(var c=0;c<l.length;c++)if("string"!=typeof l[c])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),u);le.getInstance().messageList(e.isOpenChannel(),e.url,n,r,i,t,a,s,o,l,function(n,t){if(t)return void O(null,t,u);var r=n.messages,i=[];for(var a in r){var s=b.build(r[a],e);s&&i.push(s)}O(i,null,u)})},t=function(e,n,t,r,i,a,s,o,l,u){if(s===E.MessageTypeFilter.ADMIN?s="ADMM":s===E.MessageTypeFilter.USER?s="MESG":s===E.MessageTypeFilter.FILE?s="FILE":s===E.MessageTypeFilter.ALL&&(s=""),!(_(n)&&"boolean"==typeof t&&_(r)&&_(i)&&"boolean"==typeof a&&"string"==typeof s&&"string"==typeof o&&Array.isArray(l)))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),u);for(var c=0;c<l.length;c++)if("string"!=typeof l[c])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),u);le.getInstance().messageListByID(e.isOpenChannel(),e.url,n,r,i,t,a,s,o,l,function(n,t){if(t)return void O(null,t,u);var r=n.messages,i=[];for(var a in r){var s=b.build(r[a],e);s&&i.push(s)}O(i,null,u)})};this.getNextMessagesByTimestamp=function(e,t,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),n(this,e,t,0,r,i,a,s,o,l)},this.getPreviousMessagesByTimestamp=function(e,t,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),n(this,e,t,r,0,i,a,s,o,l)},this.getPreviousAndNextMessagesByTimestamp=function(e,t,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),n(this,e,!0,t,r,i,a,s,o,l)},this.getNextMessagesByID=function(e,n,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),t(this,e,n,0,r,i,a,s,o,l)},this.getPreviousMessagesByID=function(e,n,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),t(this,e,n,r,0,i,a,s,o,l)},this.getPreviousAndNextMessagesByID=function(e,n,r,i,a,s,o,l){return"function"!=typeof o||l||(l=o,o=[]),t(this,e,!0,n,r,i,a,s,o,l)};var r=function(e,n,t){var r=Ee.getInstance(),i=r.currentUser;i&&n._sender&&i.userId===n._sender.userId&&(i.nickname!==n._sender.nickname&&(i.nickname=n._sender.nickname),i.profileUrl!==n._sender.profileUrl&&(i.profileUrl=n._sender.profileUrl)),e.isGroupChannel()&&Y.getChannel(e.url,function(e,i){if(P){var a=e;e=i,i=a}if(i)return void O(null,i,t);e.lastMessage=n;for(var s in r.channelHandlers){r.channelHandlers[s].onChannelChanged(e)}}),O(n,null,t)};this._sendFileCommand=function(e,n,t,i,a,s,o,l,u,c,d,h,p,_){var f,E=this;f=_?_.reqId:q.generateRequestId();var g=q.bFile(f,e,n,t,i,a,s,o,l,u,c,d,h),m=null;if("string"==typeof n){var A=Ee.getInstance();if(A.getConnectionState()!==A.ConnectionState.OPEN&&A.currentUser&&!A.connecting)le.getInstance().sendFileMessage(E,n,t,a,i,s,o,l,u,c,d,h,function(e,n){if(n)return void O(null,n,p);var t=new F(e);r(E,t,p)});else{var v=null,C=null,N=!1,y=null,R=null,U=F.build(g.requestId,0,A.currentUser,this,"string"==typeof n?n:"",t,i,a,s,o,v,C,N,y,c,R,d);m=new F(U),A.sendCommand(g,function(e,n){if(n)return void O(null,new I(n.message,n.code),p);var t=new F(e.getJsonElement());r(E,t,p)})}}else if(Ee.getInstance().getConnectionState()===Ee.getInstance().ConnectionState.OPEN){var v=null,C=null,N=!1,y=null,R=null,U=F.build(g.requestId,0,Ee.getInstance().currentUser,this,"string"==typeof n?n:"",t,i,a,s,o,v,C,N,y,c,R,d);m=new F(U)}return m},this._getSendFileMessageParamInfo=function(e){var n={file:null,name:null,type:null,size:null,data:"",customType:"",thumbnailSizes:[],callback:null,progressHandler:null,mentionType:pe.MentionType.USERS,mentionedUserIds:[],pushNotificationDeliveryOption:fe.PushNotificationDeliveryOption.DEFAULT};switch("function"==typeof e.slice(-1)[0]&&(n.callback=e.pop()),"function"==typeof e.slice(-1)[0]&&(n.progressHandler=e.pop()),e.length){case 1:if(e[0]instanceof fe){var t=e[0];n.file=t.file?t.file:t.fileUrl,n.name=t.fileName,n.type=t.mimeType,n.size=t.fileSize,n.data=t.data,n.customType=t.customType,n.thumbnailSizes=t.thumbnailSizes,n.mentionType=t._mentionType,n.mentionedUserIds=t._mentionedIds,n.pushNotificationDeliveryOption=t.pushNotificationDeliveryOption?t.pushNotificationDeliveryOption:fe.PushNotificationDeliveryOption.DEFAULT}else n.file=e[0];break;case 2:n.file=e[0],n.data=e[1];break;case 3:n.file=e[0],n.data=e[1],n.customType=e[2];break;case 4:n.file=e[0],n.data=e[1],n.customType=e[2],n.thumbnailSizes=e[3];break;case 5:n.file=e[0],n.name=e[1],n.type=e[2],n.size=e[3],n.data=e[4];break;case 6:n.file=e[0],n.name=e[1],n.type=e[2],n.size=e[3],n.data=e[4],n.customType=e[5];break;case 7:n.file=e[0],n.name=e[1],n.type=e[2],n.size=e[3],n.data=e[4],n.customType=e[5],n.thumbnailSizes=e[6]}return"string"!=typeof n.file&&null!==n.file&&(null!==n.name&&"undefined"!=typeof n.name&&n.name||(n.name=n.file.name),null!==n.type&&"undefined"!=typeof n.type&&n.type||(n.type=n.file.type),null!==n.size&&"undefined"!=typeof n.size||(n.size=n.file.size)),null!==n.name&&"undefined"!=typeof n.name||(n.name=""),null!==n.type&&"undefined"!=typeof n.type||(n.type=""),null!==n.size&&"undefined"!=typeof n.size||(n.size=0),n},this.sendFileMessage=function(){var e=this,n=this._getSendFileMessageParamInfo(Array.prototype.slice.call(arguments)),t=n.file,r=n.name,i=n.type,a=n.size,s=n.data,o=n.customType,l=n.thumbnailSizes,u=n.callback,c=n.progressHandler,d=n.mentionType,h=n.mentionedUserIds,p=n.pushNotificationDeliveryOption;if(null!==l&&void 0!==l||(l=[]),null===t||void 0===t||null!==r&&void 0!==r&&"string"!=typeof r||null!==i&&void 0!==i&&"string"!=typeof i||null!==a&&void 0!==a&&(!_(a)||parseInt(a)<0)||null!==s&&void 0!==s&&"string"!=typeof s||null!==o&&void 0!==o&&"string"!=typeof o||!Array.isArray(l)||[fe.PushNotificationDeliveryOption.DEFAULT,fe.PushNotificationDeliveryOption.SUPPRESS].indexOf(p)<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),u);var f=e.url,E=null;return Ee.getInstance()&&Ee.getInstance().currentUser?("string"==typeof t?E=e._sendFileCommand(f,t,r,i,a,s,o,[],!1,d,h,p,u):(E=e._sendFileCommand(f,t,r,i,a,s,o,[],!1,d,h,p,u),le.getInstance().uploadFile(t,i,l,f,function(n,t){if(t)return void O(null,t,u);var l="object"==typeof n?n:JSON.parse(n),c=l.url,_=l.hasOwnProperty("thumbnails")?l.thumbnails:[],I=!!l.hasOwnProperty("require_auth")&&l.require_auth;e._sendFileCommand(f,c,r,i,a,s,o,_,I,d,h,p,u,E)},c,this.fileUploadRequest,E?E.reqId:null)),E):(u&&O(null,new I("Connection should be made first.",te.CONNECTION_REQUIRED),u),E)},this.cancelUploadingFileMessage=function(e,n){if(!_(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var t=this,r=t.fileUploadRequest[e];return r?(r.upload.onabort=function(){delete t.fileUploadRequest[e],O(!0,null,n)},r.abort(),!0):(O(!1,new I("Uploading has been completed or cancelled.",te.FILE_UPLOAD_CANCEL_FAILED),n),!1)},this.sendUserMessage=function(e,n,t,r,i){var a=this,s=pe.MentionType.USERS,o=[],l=_e.PushNotificationDeliveryOption.DEFAULT;if("function"==typeof n&&(i=n,n="",t="",r=[],e instanceof _e)){var u=e;e=u.message,n=u.data,t=u.customType,r=u.targetLanguages,s=u._mentionType,o=u._mentionedIds,l=u.pushNotificationDeliveryOption?u.pushNotificationDeliveryOption:_e.PushNotificationDeliveryOption.DEFAULT}if("function"==typeof t&&(i=t,t="",r=[]),"function"==typeof r&&(i=r,r=[]),r||(r=[]),"string"==typeof r&&(r=[r]),null===n&&(n=""),null===t&&(t=""),"string"!=typeof e||"string"!=typeof n||"string"!=typeof t||!Array.isArray(r)||[_e.PushNotificationDeliveryOption.DEFAULT,_e.PushNotificationDeliveryOption.SUPPRESS].indexOf(l)<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i);var c=null;if(!Ee.getInstance()||!Ee.getInstance().currentUser)return i&&O(null,new I("Connection should be made first.",te.CONNECTION_REQUIRED),i),c;var d=q.bMessage(this.url,e,n,t,s,o,r,l),h=w.build(d.requestId,0,Ee.getInstance().currentUser,this,e,n,t,r,(new Date).getTime(),null,s,null,o);return c=new w(h),Ee.getInstance().sendCommand(d,function(e,n){if(n)return void O(null,new I(n.message,n.code),i);var t=new w(e.getJsonElement()),r=Ee.getInstance().currentUser;r&&t._sender&&r.userId===t._sender.userId&&(r.nickname!==t._sender.nickname&&(r.nickname=t._sender.nickname),r.profileUrl!==t._sender.profileUrl&&(r.profileUrl=t._sender.profileUrl)),a.isGroupChannel()&&Y.getChannel(a.url,function(e,n){if(P){var r=e;e=n,n=r}if(n)return void O(null,n,i);e.lastMessage=t;for(var a in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[a].onChannelChanged(e)}}),O(t,null,i)}),c},this.updateUserMessage=function(e,n,t,r,i){var a=Array.prototype.slice.call(arguments);"function"==typeof a.slice(-1)[0]&&(i=a.pop());var s=null,o=null;switch(a.length){case 2:if(a[1]instanceof _e)n=a[1].message,t=a[1].data,r=a[1].customType,s=a[1]._mentionType,o=a[1]._mentionedIds;else{if("string"!=typeof a[1])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i);n=a[1]}break;case 3:case 4:break;default:return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i)}if(!_(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i);if("string"!=typeof n&&null!==n&&void 0!==n||"string"!=typeof t&&null!==t&&void 0!==t||"string"!=typeof r&&null!==r&&void 0!==r||"string"!=typeof s&&null!==s&&void 0!==s||"string"==typeof s&&[pe.MentionType.CHANNEL,pe.MentionType.USERS].indexOf(s)<0||!Array.isArray(o)&&null!==o&&void 0!==o)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i);var l=q.bUpdateUserMessage(this.url,e,n,t,r,s,o);Ee.getInstance().sendCommand(l,function(e,n){if(n)return void O(null,new I(n.message,n.code),i);var t=new w(e.getJsonElement());O(t,null,i)})},this.updateFileMessage=function(e,n,t,r){var i=Array.prototype.slice.call(arguments);"function"==typeof i.slice(-1)[0]&&(r=i.pop());var a=null,s=null;switch(i.length){case 2:if(i[1]instanceof fe)n=i[1].data,t=i[1].customType,a=i[1]._mentionType,s=i[1]._mentionedIds;else{if("string"!=typeof i[1])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);n=i[1]}break;case 3:break;default:return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r)}if(!_(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);if("string"!=typeof n&&null!==n&&void 0!==n||"string"!=typeof t&&null!==t&&void 0!==t||"string"!=typeof a&&null!==a&&void 0!==a||"string"==typeof a&&[pe.MentionType.CHANNEL,pe.MentionType.USERS].indexOf(a)<0||!Array.isArray(s)&&null!==s&&void 0!==s)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);var o=q.bUpdateFileMessage(this.url,e,n,t,a,s);Ee.getInstance().sendCommand(o,function(e,n){if(n)return void O(null,new I(n.message,n.code),r);var t=new F(e.getJsonElement());O(t,null,r)})},this.createMetaCounters=function(e,n){if(null===e||"object"!=typeof e||Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);for(var t in e)if("number"!=typeof e[t])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().createMetaCounters(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.updateMetaCounters=function(e,n,t){if("function"!=typeof n&&void 0!==t||(t=n,n=!1),null==e||"object"!=typeof e||Array.isArray(e)||p(e)||"boolean"!=typeof n)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t);le.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,n,le.UPDATE_META_COUNTER_MODE_SET,function(e,n){if(n)return void O(null,n,t);O(e,null,t)})},this.increaseMetaCounters=function(e,n){if(null==e||"object"!=typeof e||Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,!1,le.UPDATE_META_COUNTER_MODE_INC,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.decreaseMetaCounters=function(e,n){if(null==e||"object"!=typeof e||Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,!1,le.UPDATE_META_COUNTER_MODE_DEC,function(e,t){if(t)return void O(null,t,n);var r=e,i={};for(var a in r){var s=r[a];i[a]=s}O(i,null,n)})},this.getMetaCounters=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getMetaCounters(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.getAllMetaCounters=function(e){le.getInstance().getAllMetaCounters(this.isOpenChannel(),this.url,function(n,t){if(t)return void O(null,t,e);O(n,null,e)})},this.deleteMetaCounter=function(e,n){if("string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().deleteMetaCounter(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.deleteAllMetaCounters=function(e){le.getInstance().deleteAllMetaCounters(this.isOpenChannel(),this.url,function(n,t){if(t)return void(e&&O(null,t,e));O(n,null,e)})},this.createMetaData=function(e,n){if(null==e||"object"!=typeof e||Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().createMetaData(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.updateMetaData=function(e,n,t){if("function"!=typeof n&&void 0!==t||(t=n,n=!1),null==e||"object"!=typeof e||Array.isArray(e)||p(e)||"boolean"!=typeof n)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t);le.getInstance().updateMetaData(this.isOpenChannel(),this.url,e,n,function(e,n){if(n)return void O(null,n,t);O(e,null,t)})},this.getMetaData=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getMetaData(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.getAllMetaData=function(e){le.getInstance().getAllMetaData(this.isOpenChannel(),this.url,function(n,t){if(t)return void O(null,t,e);O(n,null,e)})},this.deleteMetaData=function(e,n){if("string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().deleteMetaData(this.isOpenChannel(),this.url,e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.deleteAllMetaData=function(e){le.getInstance().deleteAllMetaData(this.isOpenChannel(),this.url,function(n,t){if(t)return void(e&&O(null,t,e));O(n,null,e)})},this.deleteMessage=function(e,n){var t=Array.prototype.slice.call(arguments);if(2!==t.length)return"function"==typeof t.slice(-1)[0]&&(n=t.pop()),void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var r=this;if("object"!=typeof e||p(e)||Array.isArray(e)||Object.keys(e).indexOf("messageId")<0||!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().deleteMessage(r.isOpenChannel(),r.url,e.messageId,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.channelType=k.CHANNEL_TYPE_BASE,e&&this._update(e)};k.CHANNEL_TYPE_OPEN="open",k.CHANNEL_TYPE_GROUP="group",k.CHANNEL_TYPE_BASE="base";var G=function(e){this.parse=function(e){if(e.hasOwnProperty("participant_count")&&(this.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&e.operators){this.operators=[];for(var n in e.operators){var t=new W(e.operators[n]);this.operators.push(t)}}},this.refresh=function(e){G.getChannelWithoutCache(this.url,function(n,t){if(P){var r=n;n=t,t=r}if(t)return void O(null,t,e);O(n,null,e)})},this.update=function(e){this._update(e),this.parse(e)},this["delete"]=function(e){var n=this.url;le.getInstance().deleteOpenChannel(n,function(t,r){if(r)return void O(null,r,e);delete G.cachedChannels[n],O(t,null,e)})},this.enter=function(e){var n=this,t=q.bEnter(n.url);Ee.getInstance().sendCommand(t,function(t,r){if(r)return void O(null,new I(r.message,r.code),e);G.enteredChannels[n.url]=n,O(null,null,e)})},this.exit=function(e){var n=this,t=q.bExit(n.url);Ee.getInstance().sendCommand(t,function(t,r){if(r)return void O(null,new I(r.message,r.code),e);delete G.enteredChannels[n.url],O(null,null,e)})},this.createParticipantListQuery=function(){return new ne(ne.PARTICIPANT,this)},this.createMutedUserListQuery=function(){return new ne(ne.MUTED_USER,this)},this.createBannedUserListQuery=function(){return new ne(ne.BANNED_USER,this)},
this.updateChannel=function(){var e=Array.prototype.slice.call(arguments),n=null,t=null,r=null,i=null,a=null,s=null;switch("function"==typeof e.slice(-1)[0]&&(s=e.pop()),e.length){case 3:n=e[0],t=e[1],r=e[2];break;case 4:n=e[0],t=e[1],r=e[2],i=e[3];break;case 5:n=e[0],t=e[1],r=e[2],i=e[3],a=e[4];break;default:return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),s)}this.updateChannelWithOperatorUserIds(n,t,r,i,a,s)},this.updateChannelWithOperatorUserIds=function(e,n,t,r,i,a){if("function"==typeof i&&(a=i,i=null),"string"!=typeof e&&null!==e&&void 0!==e||"string"!=typeof n&&p(n)&&null!==n&&void 0!==n||"string"!=typeof t&&null!==t&&void 0!==t||"string"!=typeof r&&!Array.isArray(r)&&null!==r&&void 0!==r||"string"!=typeof i&&null!==i&&void 0!==i)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a);le.getInstance().updateOpenChannel(this.url,e,n,t,r,i,function(e,n){if(n)return void O(null,n,a);var t=G.upsert(e);O(t,null,a)})},this.banUser=function(e,n,t){if("function"==typeof n&&3!==arguments.length&&(t=n,n=-1),!e||"number"!=typeof n||parseInt(n)<0&&-1!==parseInt(n))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t);this.banUserWithUserId(e.userId,n,t)},this.banUserWithUserId=function(e,n,t){if("function"==typeof n&&3!==arguments.length&&(t=n,n=-1),!e||parseInt(n)<0&&-1!==parseInt(n))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t);le.getInstance().banUser(this.url,e,null,n,!1,function(e,n){if(n)return void O(null,n,t);O(null,null,t)})},this.unbanUser=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.unbanUserWithUserId(e.userId,n)},this.unbanUserWithUserId=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().unbanUser(this.url,e,!1,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.muteUser=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.muteUserWithUserId(e.userId,n)},this.muteUserWithUserId=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().muteUser(this.url,e,!1,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.unmuteUser=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.unmuteUserWithUserId(e.userId,n)},this.unmuteUserWithUserId=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().unmuteUser(this.url,e,!1,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.isOperator=function(e){return!!e&&this.isOperatorWithUserId(e.userId)},this.isOperatorWithUserId=function(e){for(var n in this.operators)if(this.operators[n].userId===e)return!0;return!1},this.channelType=k.CHANNEL_TYPE_OPEN,this.participantCount=0,this.operators=[],e&&(this._update(e),this.parse(e))};f(k,G),G.enteredChannels={},G.clearEnteredChannels=function(){G.enteredChannels={}},G.createOpenChannelListQuery=function(){return new $},G.buildFromSerializedData=function(e){var n=m(e);return new G({channel_url:n.url,name:n.name,cover_url:n.coverUrl,data:n.data,custom_type:n.customType,created_at:n.createdAt/1e3,freeze:n.isFrozen,is_ephemeral:n.isEphemeral,participant_count:n.participantCount,operators:n.operators.map(function(e){return W.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName)})})},G.createChannel=function(){var e,n,t,r,i,a;switch(arguments.length){case 1:a=arguments[0];break;case 4:e=arguments[0],n=arguments[1],t=arguments[2],a=arguments[3];break;case 5:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],a=arguments[4];break;case 6:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],a=arguments[5]}G.createChannelWithOperatorUserIds(e,n,t,r,i,a)},G.upsert=function(e){var n=new G(e);return G.cachedChannels.hasOwnProperty(n.url)?G.cachedChannels[n.url].update(e):G.cachedChannels[n.url]=n,G.cachedChannels[n.url]},G.createChannelWithOperatorUserIds=function(e,n,t,r,i,a){if("function"==typeof i&&(a=i,i=""),"string"!=typeof e&&null!==e&&void 0!==e||"string"!=typeof n&&p(n)&&null!==n&&void 0!==n||"string"!=typeof t&&null!==t&&void 0!==t||"string"!=typeof r&&!Array.isArray(r)&&null!==r&&void 0!==r||"string"!=typeof i&&null!==i&&void 0!==i)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a);le.getInstance().createOpenChannel(e,n,t,r,i,function(e,n){if(n)return void O(null,n,a);var t=G.upsert(e);O(t,null,a)})},G.cachedChannels={},G.clearCache=function(){G.cachedChannels={}},G.removeCachedChannel=function(e){delete G.cachedChannels[e]},G.getChannel=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);G.cachedChannels.hasOwnProperty(e)?O(G.cachedChannels[e],null,n):G.getChannelWithoutCache(e,n)},G.getChannelWithoutCache=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getOpenChannel(e,function(t,r){if(r)return void O(null,r,n);G.upsert(t),O(G.cachedChannels[e],null,n)})};var V=function(){this.channelCustomTypesFilter=[],this.superChannelFilter=Y.superChannelFilter.ALL},Y=function(e){var t={},r=0,i=0;this.parse=function(e){var n=this;if(n.isDistinct=!!e.is_distinct&&e.is_distinct,n.isPushEnabled=!!e.is_push_enabled&&e.is_push_enabled,n.isHidden=!!e.hasOwnProperty("is_hidden")&&e.is_hidden,n.myCountPreference=e.hasOwnProperty("count_preference")?e.count_preference:Y.CountPreference.ALL,n.unreadMessageCount=0,n.unreadMentionCount=0,A(n,parseInt(e.unread_message_count),parseInt(e.unread_mention_count)),e.hasOwnProperty("read_receipt")){n.cachedReadReceiptStatus={};for(var t in e.read_receipt){var r=e.read_receipt[t];n.updateReadReceipt(t,parseInt(r))}}if(e.hasOwnProperty("members")){n.members=[],n.memberMap={};e.members.forEach(function(e){var t=new j(e);n.members.push(t),n.memberMap[t.userId]=t})}e.hasOwnProperty("member_state")?n.myMemberState=e.member_state:n.myMemberState="none",e.hasOwnProperty("my_role")?n.myRole=e.my_role||Y.Role.NONE:n.myRole=Y.Role.NONE,e.hasOwnProperty("is_muted")?"string"==typeof e.is_muted?n.myMutedState=e.is_muted:"boolean"==typeof e.is_muted&&(n.myMutedState=e.is_muted?"muted":"unmuted"):n.myMutedState="unmuted",e.hasOwnProperty("member_count")&&(n.memberCount=parseInt(e.member_count)),e.hasOwnProperty("joined_member_count")&&(n.joinedMemberCount=parseInt(e.joined_member_count)),e.hasOwnProperty("last_message")&&"object"==typeof e.last_message&&e.last_message?e.last_message instanceof b?n.lastMessage=e.last_message:n.lastMessage=b.build(e.last_message,n):n.lastMessage=null,e.hasOwnProperty("inviter")&&null!==e.inviter&&"object"==typeof e.inviter&&!p(e.inviter)?n.inviter=new W(e.inviter):n.inviter=null,n.invitedAt=e.invited_at||0,e.hasOwnProperty("is_super")&&null!==e.is_super&&"boolean"==typeof e.is_super?n.isSuper=e.is_super:n.isSuper=!1,e.hasOwnProperty("is_public")&&null!==e.is_public&&"boolean"==typeof e.is_public?n.isPublic=e.is_public:n.isPublic=!1},this.refresh=function(e){Y.getChannelWithoutCache(this.url,function(n,t){if(P){var r=n;n=t,t=r}if(t)return void O(null,t,e);O(n,null,e)})},this.update=function(e){this._update(e),this.parse(e)},this.updateChannel=function(){var e=this,n=Array.prototype.slice.call(arguments),t=null,r=null,i=null,a=null,s=null,o=null,l=null;switch("function"==typeof n.slice(-1)[0]&&(o=n.pop()),n.length){case 1:if(!(n[0]instanceof he))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),o);var u=n[0];t=u.isDistinct,r=u.name,i=u.channelCover,a=u.data,s=u.customType,l=u.isPublic;break;case 3:t=e.isDistinct,r=n[0],i=n[1],a=n[2];break;case 4:t=n[0],r=n[1],i=n[2],a=n[3];break;case 5:t=n[0],r=n[1],i=n[2],a=n[3],s=n[4];break;default:return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),o)}if("string"!=typeof r&&null!==r&&void 0!==r||"string"!=typeof i&&p(i)&&null!==i&&void 0!==i||"string"!=typeof a&&null!==a&&void 0!==a||"boolean"!=typeof t&&null!==t||"boolean"!=typeof l&&null!==l||"string"!=typeof s&&null!==s&&void 0!==s)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),o);le.getInstance().updateGroupChannel(e.url,t,r,i,a,s,l,function(e,n){if(n)return void O(null,n,o);var t=Y.upsert(e);O(t,null,o)})},this.resetMyHistory=function(e){le.getInstance().resetMyHistory(this.url,function(n,t){if(t)return void O(null,t,e);O(n,null,e)})},this.invite=function(e,n){if("string"==typeof e&&(e=[{userId:e}]),!Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var t=[];for(var r in e){if("object"!=typeof e[r]||p(e[r])){O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);break}t.push(e[r].userId)}this.inviteWithUserIds(t,n)},this.inviteWithUserIds=function(e,n){if(!Array.isArray(e)||p(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().groupChannelInvite(this.url,e,function(e,t){if(t)return void O(null,t,n);var r=Y.upsert(e);O(r,null,n)})},this.acceptInvitation=function(e){le.getInstance().acceptInvitation(this.url,function(n,t){if(t)return void O(null,t,e);var r=Y.upsert(n);r.myMemberState="joined",Y.cachedChannels[r.url]=r,O(r,null,e)})},this.declineInvitation=function(e){var n=this;le.getInstance().declineInvitation(this.url,function(t,r){if(r)return void O(null,r,e);n.myMemberState="none",Y.cachedChannels[n.url]=n,n.isPublic||Y.removeCachedChannel(n.url),O(t,null,e)})},this.hide=function(e,n){if(1===arguments.length&&"function"==typeof e&&(n=e,e=!1),null!==e&&void 0!==e||(e=!1),"boolean"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var t=this.url,r=this;le.getInstance().groupChannelHide(t,e,function(i,a){if(a)return void O(null,a,n);r.isHidden=!0;var s=Y.cachedChannels[t];s&&(s.isHidden=!0,e&&A(s,0,0),Y.cachedChannels[t]=s),O(i,null,n)})},this.join=function(e){var n=this.url;le.getInstance().publicGroupChannelJoin(n,function(n,t){if(t)return void O(null,t,e);var r=Y.upsert(n);r.myMemberState="joined",Y.cachedChannels[r.url]=r,O(r,null,e)})},this.leave=function(e){var n=this.url;le.getInstance().groupChannelLeave(n,function(n,t){if(t)return void O(null,t,e);O(null,null,e)})},this.markAsRead=function(){this._sendMarkAsRead(null)},this._sendMarkAsRead=function(e){var n=this,t=q.bRead(n.url);Ee.getInstance().sendCommand(t,function(t,r){if(r)return void O(null,new I(r.message,r.code),e);if(n.updateReadReceipt(Ee.getInstance().getCurrentUserId(),t.getJsonElement().ts),n.unreadMessageCount>0||n.unreadMentionCount>0){A(n,0,0);for(var i in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[i].onChannelChanged(n)}}O(null,null,e)})},this.getReadReceipt=function(e){if(!(e instanceof b))return n.log("message is not BaseMessage instance"),-1;if(e.messageType===b.MESSAGE_TYPE_ADMIN)return 0;var t=Ee.getInstance().currentUser,r=0,i=e.createdAt,a=this.members;for(var s in a){var o=a[s],l=o.userId;if(!(t.userId===l||e.sender&&e.sender.userId===l)){var u=this.cachedReadReceiptStatus[l];u||(u=0),u<i&&r++}}return this.isSuper?0:r},this.getReadStatus=function(){var e={};if(!Ee.getInstance().currentUser)return e;var n=this.members;for(var t in n){var r=n[t],i=r.userId;if(r.userId!==Ee.getInstance().getCurrentUserId()){var a=this.cachedReadReceiptStatus[i];e[i]={user:r,last_seen_at:parseInt(a)}}}return e},this.updateReadReceipt=function(e,n){var t=e,r=this.cachedReadReceiptStatus[t],i=n;(!r||r<i)&&(this.cachedReadReceiptStatus[t]=i)},this.startTyping=function(){var e=(new Date).getTime(),n=Ee.getInstance().Options.typingIndicatorThrottle;if(("number"!=typeof n||n<a||n>s)&&(n=1e3),e-r>=n){i=0,r=e;var t=q.bTypeStart(this.url,r);Ee.getInstance().sendCommand(t,null)}},this.endTyping=function(){var e=(new Date).getTime(),n=Ee.getInstance().Options.typingIndicatorThrottle;if(("number"!=typeof n||n<a||n>s)&&(n=1e3),e-i>=n){r=0,i=e;var t=q.bTypeEnd(this.url,i);Ee.getInstance().sendCommand(t,null)}},this.invalidateTypingStatus=function(){var e=!1,n=(new Date).getTime();for(var r in t){n-t[r]>=1e4&&(delete t[r],e=!0)}return e},this.updateTypingStatus=function(e,n){n?t[e.userId]=(new Date).getTime():delete t[e.userId]},this.isTyping=function(){return 0!==Object.keys(t).length},this.getTypingMembers=function(){var e=[];for(var n in t){var r=this.memberMap[n];this.memberMap[n]&&e.push(r)}return e},this.addMember=function(e){if(!this.isSuper){var n=this.removeMember(e);n&&n.state===j.JOINED&&(e.state=j.JOINED),this.memberMap[e.userId]=e,this.members.push(e),this.memberCount++,this.updateReadReceipt(e.userId,0)}},this.removeMember=function(e){var n=null;if(!this.isSuper){var t=e.userId;if(this.memberMap.hasOwnProperty(e.userId)){delete this.memberMap[e.userId];for(var r in this.members){var i=this.members[r];if(i.userId===t){n=i,this.members.splice(r,1);break}}this.memberCount--}}return n},this.updateJoinedMemberCount=function(){if(!this.isSuper){for(var e=0,n=this.members.length,t=0;t<n;t++)this.members[t].state===j.JOINED&&e++;this.joinedMemberCount=e}};var o=0;this.setLatestMemberCount=function(e,n,t){"number"==typeof e&&"number"==typeof n&&"number"==typeof t&&t>=o&&(o=t,this.memberCount=e,this.joinedMemberCount=n)},this.setPushPreference=function(e,n){var t=this;le.getInstance().setPushPreference(this.url,e,function(e,r){if(r)return void O(null,r,n);t.isPushEnabled=e.enable,O(e,null,n)})},this.getPushPreference=function(e){var n=this;le.getInstance().getPushPreference(this.url,function(t,r){if(r)return void O(null,r,e);if(e){var i;try{i=t.enable}catch(e){i=!1}n.isPushEnabled=i,O(i,null,e)}})},this.setMyCountPreference=function(e,n){if([Y.CountPreference.ALL,Y.CountPreference.UNREAD_MESSAGE_COUNT_ONLY,Y.CountPreference.UNREAD_MENTION_COUNT_ONLY,Y.CountPreference.OFF].indexOf(e)<0)return void O(null,new I("Invalid parameters.",te.INVALID_PARAMETER),n);var t=this;le.getInstance().setCountPreference(this.url,e,function(e,r){if(r)return void O(null,r,n);t.myCountPreference=e.count_preference,A(t,t.unreadMessageCount,t.unreadMentionCount),O(t.myCountPreference,null,n)})},this.createMemberListQuery=function(){var e=this.url;return new J(e)},this.banUser=function(e,n,t,r){if(!e||!e.hasOwnProperty("userId")||"string"!=typeof t)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);this.banUserWithUserId(e.userId,n,t,r)},this.banUserWithUserId=function(e,n,t,r){if(!e||"string"!=typeof e||"string"!=typeof t)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);le.getInstance().banUser(this.url,e,t,n,!0,function(e,n){if(n)return void O(null,n,r);O(null,null,r)})},this.unbanUser=function(e,n){if(!e||!e.hasOwnProperty("userId"))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.unbanUserWithUserId(e.userId,n)},this.unbanUserWithUserId=function(e,n){if(!e||"string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().unbanUser(this.url,e,!0,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.muteUser=function(e,n){if(!e||!e.hasOwnProperty("userId"))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.muteUserWithUserId(e.userId,n)},this.muteUserWithUserId=function(e,n){if(!e||"string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().muteUser(this.url,e,!0,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.unmuteUser=function(e,n){if(!e||!e.hasOwnProperty("userId"))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.unmuteUserWithUserId(e.userId,n)},this.unmuteUserWithUserId=function(e,n){if(!e||"string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().unmuteUser(this.url,e,!0,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.freeze=function(e){le.getInstance().freeze(this.url,!0,!0,function(n,t){if(t)return void O(null,t,e);Y.upsert(n),O(null,null,e)})},this.unfreeze=function(e){le.getInstance().freeze(this.url,!0,!1,function(n,t){if(t)return void O(null,t,e);Y.upsert(n),O(null,null,e)})},this.createBannedUserListQuery=function(){return new ne(ne.BANNED_USER,this)},this.channelType=k.CHANNEL_TYPE_GROUP,this.isDistinct=!1,this.isSuper=!1,this.isPublic=!1,this.unreadMessageCount=0,this.inviter=null,this.members=[],this.memberMap={},this.lastMessage={},this.memberCount=0,this.joinedMemberCount=0,this.cachedReadReceiptStatus={},this.isPushEnabled,this.isHidden=!1,e&&(this._update(e),this.parse(e))};f(k,Y),Y.buildFromSerializedData=function(e){var n=m(e);return new Y({channel_url:n.url,name:n.name,cover_url:n.coverUrl,data:n.data,custom_type:n.customType,invited_at:n.invitedAt,created_at:n.createdAt/1e3,is_distinct:n.isDistinct,is_super:n.isSuper,is_public:n.isPublic,freeze:n.isFrozen,is_ephemeral:n.isEphemeral,unread_message_count:n.unreadMessageCount,unread_mention_count:n.unreadMentionCount,is_push_enabled:n.isPushEnabled,count_preference:n.myCountPreference,is_hidden:n.isHidden,member_count:n.memberCount,joined_member_count:n.joinedMemberCount,member_state:n.myMemberState,my_role:n.myRole,is_muted:n.myMutedState,members:n.members.map(function(e){return j.build(W.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName),e.state,e.isBlockedByMe,e.isBlockingMe)}),last_message:function(e){return null!==e&&void 0!==e&&"object"==typeof e?e.messageType===b.MESSAGE_TYPE_USER?new w(w.build(e.reqId,e.messageId,e.sender,{url:e.channelUrl,channelType:e.channelType},e.message,e.data,e.customType,e.translations,e.createdAt,e.updatedAt,e.mentionType,e.mentionedUsers)):e.messageType===b.MESSAGE_TYPE_FILE?new F(F.build(e.reqId,e.messageId,e.sender,{url:e.channelUrl,channelType:e.channelType},e.url,e.name,e.type,e.size,e.data,e.customType,e.createdAt,e.thumbnails,e.requireAuth,e.updatedAt,e.mentionType,e.mentionedUsers)):new H(H.build(e.messageId,{url:e.channelUrl,channelType:e.channelType},e.message,e.data,e.customType,e.translations,e.createdAt,e.updatedAt,e.mentionType,e.mentionedUsers)):null}(n.lastMessage),read_receipt:n.cachedReadReceiptStatus,inviter:null!==n.inviter&&"undefined"!=typeof n.inviter&&"object"==typeof n.inviter?W.build(n.inviter.userId,n.inviter.nickname,n.inviter.profileUrl,n.inviter.connectionStatus,n.inviter.lastSeenAt,n.inviter.metaData,n.inviter.isActive,n.inviter.friendDiscoveryKey,n.inviter.friendName):null})},Y.createMyGroupChannelListQuery=function(){return new Q},Y.createPublicGroupChannelListQuery=function(){return new Z},Y.memberState={ALL:0,JOINED:1,INVITED:2,INVITED_BY_FRIEND:3,INVITED_BY_NON_FRIEND:4},Y.memberStateFilter={ALL:"all",JOINED:"joined_only",INVITED:"invited_only",INVITED_BY_FRIEND:"invited_by_friend",INVITED_BY_NON_FRIEND:"invited_by_non_friend"},Y.superChannelFilter={ALL:"all",SUPER:"super",NON_SUPER:"nonsuper"},Y.publicChannelFilter={ALL:"all",PUBLIC:"public",PRIVATE:"private"},Y.Role={OPERATOR:"operator",NONE:"none"},Y.UnreadItemKey={GROUP_CHANNEL_UNREAD_MENTION_COUNT:"group_channel_unread_mention_count",NONSUPER_UNREAD_MENTION_COUNT:"non_super_group_channel_unread_mention_count",SUPER_UNREAD_MENTION_COUNT:"super_group_channel_unread_mention_count",GROUP_CHANNEL_UNREAD_MESSAGE_COUNT:"group_channel_unread_message_count",NONSUPER_UNREAD_MESSAGE_COUNT:"non_super_group_channel_unread_message_count",SUPER_UNREAD_MESSAGE_COUNT:"super_group_channel_unread_message_count",GROUP_CHANNEL_INVITATION_COUNT:"group_channel_invitation_count",NONSUPER_INVITATION_COUNT:"non_super_group_channel_invitation_count",SUPER_INVITATION_COUNT:"super_group_channel_invitation_count"},Y.CountPreference={ALL:"all",UNREAD_MESSAGE_COUNT_ONLY:"unread_message_count_only",UNREAD_MENTION_COUNT_ONLY:"unread_mention_count_only",OFF:"off"},Y.getChannelCount=function(e,n){if("function"==typeof e&&1===arguments.length&&(n=e,e=Y.memberState.ALL),e!==Y.memberState.ALL&&e!==Y.memberState.JOINED&&e!==Y.memberState.INVITED&&e!==Y.memberState.INVITED_BY_FRIEND&&e!==Y.memberState.INVITED_BY_NON_FRIEND)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getGroupChannelCount(e,function(e,t){if(t)return void O(null,t,n);var r=parseInt(e.group_channel_count);O(r,null,n)})},Y.getUnreadItemCount=function(e,n){if(!Array.isArray(e)||e.length<1)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);for(var t=0;t<e.length;t++){if([Y.UnreadItemKey.SUPER_UNREAD_MESSAGE_COUNT,Y.UnreadItemKey.NONSUPER_UNREAD_MESSAGE_COUNT,Y.UnreadItemKey.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT,Y.UnreadItemKey.SUPER_UNREAD_MENTION_COUNT,Y.UnreadItemKey.NONSUPER_UNREAD_MENTION_COUNT,Y.UnreadItemKey.GROUP_CHANNEL_UNREAD_MENTION_COUNT,Y.UnreadItemKey.SUPER_INVITATION_COUNT,Y.UnreadItemKey.NONSUPER_INVITATION_COUNT,Y.UnreadItemKey.GROUP_CHANNEL_INVITATION_COUNT].indexOf(e[t])<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n)}var r=e.filter(function(n,t){return e.indexOf(n)===t});le.getInstance().getUnreadItemCount(r,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},Y.getTotalUnreadMessageCount=function(e,n){"function"==typeof e&&(n=e,e=null);var t=e,r=Y.superChannelFilter.ALL;if(e instanceof V&&(t=e.channelCustomTypesFilter,r=e.superChannelFilter),null!==t&&void 0!==t&&!Array.isArray(t)||"string"!=typeof r&&[Y.superChannelFilter.ALL,Y.superChannelFilter.SUPER,Y.superChannelFilter.NON_SUPER].indexOf(r)<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getTotalUnreadMessageCount(t,r,function(e,t){if(t)return void O(null,t,n);var r=parseInt(e.unread_count);O(r,null,n)})},Y.getTotalUnreadChannelCount=function(e){le.getInstance().getTotalUnreadChannelCount(function(n,t){if(t)return void O(null,t,e);var r=parseInt(n.unread_count);O(r,null,e)})},Y.createChannel=function(){var e=null,n=[],t=null,r=null,i=null,a=null,s=null,o=null,l=null,u={isPublic:null,channelUrl:null},c=[],d=null;switch(arguments.length){case 2:if(arguments[0]instanceof he){var h=arguments[0];n=h._inviteUserIds,e=[],t=h.isDistinct,r=h.isSuper,i=h.name,a=h.channelCover,s=h.data,l=h.customType,c=h._operatorIds,u.isPublic=h.isPublic,u.channelUrl=h.channelUrl,d=h.isEphemeral,o=arguments[1];break}e=arguments[0],t=!1,o=arguments[1];break;case 3:e=arguments[0],t=arguments[1],o=arguments[2];break;case 4:e=arguments[0],t=arguments[1],l=arguments[2],o=arguments[3];break;case 6:e=arguments[0],t=arguments[1],i=arguments[2],a=arguments[3],s=arguments[4],o=arguments[5];break;case 7:e=arguments[0],t=arguments[1],i=arguments[2],a=arguments[3],s=arguments[4],l=arguments[5],o=arguments[6]}if(!Array.isArray(e)||"boolean"!=typeof t&&null!==t||"boolean"!=typeof r&&null!==r||"boolean"!=typeof d&&null!==d||"boolean"!=typeof u.isPublic&&null!==u.isPublic||"string"!=typeof u.channelUrl&&null!==u.channelUrl||"string"!=typeof i&&null!==i&&void 0!==i||"string"!=typeof a&&p(a)&&null!==a&&void 0!==a||"string"!=typeof s&&null!==s&&void 0!==s||"string"!=typeof l&&null!==l&&void 0!==l)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),o);e.forEach(function(e){n.push(e.userId)}),Y.createChannelWithUserIds(n,t,i,a,s,l,r,u,c,d,o)},Y.createChannelWithUserIds=function(){var e=null,n=null,t=null,r=null,i=null,a=null,s=null,o=null,l=[],u={isPublic:null,channelUrl:null},c=null;switch(arguments.length){case 2:e=arguments[0],n=!1,a=arguments[1];break;case 3:e=arguments[0],n=arguments[1],a=arguments[2];break;case 4:e=arguments[0],n=arguments[1],s=arguments[2],a=arguments[3];break;case 6:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],a=arguments[5];break;case 7:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],s=arguments[5],a=arguments[6];break;case 8:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],s=arguments[5],o=arguments[6],a=arguments[7];break;case 9:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],s=arguments[5],o=arguments[6],u.isPublic=arguments[7].isPublic,u.channelUrl=arguments[7].channelUrl,a=arguments[8];break;case 10:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],s=arguments[5],o=arguments[6],u.isPublic=arguments[7].isPublic,u.channelUrl=arguments[7].channelUrl,l=arguments[8],a=arguments[9];break;case 11:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4],s=arguments[5],o=arguments[6],u.isPublic=arguments[7].isPublic,u.channelUrl=arguments[7].channelUrl,l=arguments[8],c=arguments[9],a=arguments[10]}if(!Array.isArray(e)||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"boolean"!=typeof c&&null!==c||"boolean"!=typeof u.isPublic&&null!==u.isPublic||"string"!=typeof u.channelUrl&&null!==u.channelUrl||"string"!=typeof t&&null!==t&&void 0!==t||"string"!=typeof r&&p(r)&&null!==r&&void 0!==r||"string"!=typeof i&&null!==i&&void 0!==i||"string"!=typeof s&&null!==s&&void 0!==s)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a);var d=e.filter(function(e,n,t){return n===t.indexOf(e)});le.getInstance().createGroupChannel(d,n,t,r,i,s,o,u,l,c,function(e,n){if(n)return void O(null,n,a);var t=new Y(e);Y.cachedChannels[t.url]=t,O(t,null,a)})},Y.cachedChannels={},Y.clearCache=function(){Y.cachedChannels={}},Y.removeCachedChannel=function(e){delete Y.cachedChannels[e]},Y.upsert=function(e){var n=new Y(e);if(Y.cachedChannels.hasOwnProperty(n.url)){if(n.isEphemeral){var t=Y.cachedChannels[n.url];e.last_message=t.lastMessage,e.unread_message_count=t.unreadMessageCount}Y.cachedChannels[n.url].update(e)}else Y.cachedChannels[n.url]=n;return Y.cachedChannels[n.url]},Y.getChannelWithoutCache=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().getGroupChannel(e,!0,!0,function(e,t){if(t)return void O(null,t,n);var r=Y.upsert(e);O(r,null,n)})},Y.getChannel=function(e,n){if(!e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);Y.cachedChannels.hasOwnProperty(e)?O(Y.cachedChannels[e],null,n):Y.getChannelWithoutCache(e,n)},Y.markAsReadAllLastSentAt,Y.markAsReadAll=function(e){Ee.getInstance().markAsReadAll(e)};var B=function(e){e&&(this.category=e.hasOwnProperty("cat")?parseInt(e.cat):0,this.data=e.hasOwnProperty("data")?e.data:null,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):k.CHANNEL_TYPE_GROUP),this.isGroupChannel=function(){return this.channelType===k.CHANNEL_TYPE_GROUP},this.isOpenChannel=function(){return this.channelType===k.CHANNEL_TYPE_OPEN}};B.CATEGORY_NONE=0,B.CATEGORY_CHANNEL_ENTER=10102,B.CATEGORY_CHANNEL_EXIT=10103,B.CATEGORY_USER_CHANNEL_MUTE=10201,B.CATEGORY_USER_CHANNEL_UNMUTE=10200,B.CATEGORY_USER_CHANNEL_BAN=10601,B.CATEGORY_USER_CHANNEL_UNBAN=10600,B.CATEGORY_CHANNEL_FREEZE=10701,B.CATEGORY_CHANNEL_UNFREEZE=10700,B.CATEGORY_TYPING_START=10900,B.CATEGORY_TYPING_END=10901,B.CATEGORY_CHANNEL_JOIN=1e4,B.CATEGORY_CHANNEL_LEAVE=10001,B.CATEGORY_CHANNEL_INVITE=10020,B.CATEGORY_CHANNEL_DECLINE_INVITE=10022,B.CATEGORY_CHANNEL_PROP_CHANGED=11e3,B.CATEGORY_CHANNEL_DELETED=12e3,B.CATEGORY_CHANNEL_META_DATA_CHANGED=11100,B.CATEGORY_CHANNEL_META_COUNTERS_CHANGED=11200,B.CATEGORY_CHANNEL_HIDE=13e3;var x=function(e){e&&(this.category=e.hasOwnProperty("cat")?parseInt(e.cat):0)};x.CATEGORY_USER_BLOCK=20001,x.CATEGORY_USER_UNBLOCK=2e4,x.CATEGORY_FRIEND_DISCOVERED=20900;var K=function(e){e&&(this.reader=new W(e.user),this.timestamp=parseInt(e.ts),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):k.CHANNEL_TYPE_GROUP)},W=function(e){this.nickname="",this.profileUrl="",this.userId="",this.connectionStatus="",this.lastSeenAt=null,this.metaData={},this.isActive=!0,this.friendDiscoveryKey=null,this.friendName=null,this.getOriginalProfileUrl=function(){var e="";if(e=this.profileUrl.indexOf("://")>-1?this.profileUrl.split("/")[2]:this.profileUrl.split("/")[0],e=e.split("?")[0],(e.indexOf("sendbird.com")>-1||e.indexOf("intoz.com")>-1)&&this.profileUrl.indexOf(e+"/profile_images/")>-1){var n=this.profileUrl.replace("profile_images/","");return n===this.profileUrl?"":n}return""},this._update=function(e){e.hasOwnProperty("guest_id")&&(this.userId=String(e.guest_id)),e.hasOwnProperty("user_id")&&(this.userId=String(e.user_id)),e.hasOwnProperty("name")&&(this.nickname=String(e.name)),e.hasOwnProperty("nickname")&&(this.nickname=String(e.nickname)),e.hasOwnProperty("image")&&(this.profileUrl=String(e.image)),e.hasOwnProperty("profile_url")&&(this.profileUrl=String(e.profile_url)),e.hasOwnProperty("is_online")?e.is_online===W.NON_AVAILABLE?this.connectionStatus=W.NON_AVAILABLE:this.connectionStatus=e.is_online?W.ONLINE:W.OFFLINE:this.connectionStatus=W.NON_AVAILABLE,e.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(e.last_seen_at):this.lastSeenAt=0,e.hasOwnProperty("metadata")?this.metaData=e.metadata:this.metaData={},e.hasOwnProperty("is_active")?this.isActive="undefined"==typeof e.is_active||e.is_active:this.isActive=!0,e.hasOwnProperty("friend_discovery_key")?this.friendDiscoveryKey=e.friend_discovery_key:this.friendDiscoveryKey=null,e.hasOwnProperty("friend_name")?this.friendName=e.friend_name:this.friendName=null},this._updateMetaData=function(e,n){var t=this,r=Object.keys(e);n?r.forEach(function(e){delete t.metaData[e]}):r.forEach(function(n){t.metaData[n]=e[n]})},this.createMetaData=function(e,n){var t=this;if("function"==typeof e&&1===arguments.length&&(n=e,e={}),"object"!=typeof e||p(e)||Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().createUserMetaData(e,function(e,r){if(r)return void O(null,r,n);t._updateMetaData(e),O(e,null,n)})},this.updateMetaData=function(e,n,t){var r=this;if("function"==typeof e&&1===arguments.length&&(t=e,e={}),"function"==typeof n&&2===arguments.length&&(t=n,n=!1),"object"!=typeof e||p(e)||Array.isArray(e)||"boolean"!=typeof n)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t);le.getInstance().updateUserMetaData(e,n,function(e,n){if(n)return void O(null,n,t);r._updateMetaData(e),O(e,null,t)})},this.deleteAllMetaData=function(e){var n=this,t=n.metaData;le.getInstance().deleteAllUserMetaData(function(r,i){if(i)return void O(null,i,e);n._updateMetaData(t,!0),O(r,null,e)})},this.deleteMetaData=function(e,n){var t=this;if("function"==typeof e&&1===arguments.length&&(n=e,e=null),"string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var r={};r[e]="",le.getInstance().deleteUserMetaData(e,function(e,i){if(i)return void O(null,i,n);t._updateMetaData(r,!0),O(e,null,n)})},this.serialize=function(){var e=JSON.parse(JSON.stringify(this));return g(e)},e&&this._update(e)};W.NON_AVAILABLE="nonavailable",W.ONLINE="online",W.OFFLINE="offline",W.build=function(e,n,t,r,i,a,s,o,l){return{user_id:e,nickname:n,profile_url:t,is_online:r,last_seen_at:i,metadata:a,is_active:s,friend_discovery_key:o,friend_name:l}},W.buildFromSerializedData=function(e){var n=m(e);return new W(W.build(n.userId,n.nickname,n.profileUrl,n.connectionStatus,n.lastSeenAt,n.metaData,n.isActive,n.friendDiscoveryKey,n.friendName))};var j=function(e){this.state="",this.isBlockedByMe=!1,this.isBlockingMe=!1,this.parse=function(e){this.state=e.state,e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me),e.hasOwnProperty("is_blocking_me")&&(this.isBlockingMe=e.is_blocking_me)},e&&(this._update(e),this.parse(e))};f(W,j),j.JOINED="joined",j.INVITED="invited",j.build=function(e,n,t,r){var i=e;return i.state=n,i.is_blocked_by_me=t,i.is_blocking_me=r,i},j.buildFromSerializedData=function(e){var n=m(e);return new j(j.build(W.build(n.userId,n.nickname,n.profileUrl,n.connectionStatus,n.lastSeenAt,n.metaData,n.isActive,n.friendDiscoveryKey,n.friendName),n.state,n.isBlockedByMe,n.isBlockingMe))};var q=function(e,n,t){
this.isAckRequired=function(){return"MESG"===this.command||"FILE"===this.command||"ENTR"===this.command||"EXIT"===this.command||"READ"===this.command||"MEDI"===this.command||"FEDI"===this.command},this.encode=function(){return this.command+this.payload+"\n"},this.decode=function(e){e=e.trim(),this.command=e.substring(0,4),this.payload=e.substring(4)},this.getJsonElement=function(){return JSON.parse(this.payload)},this.isRequestIdCommand=function(){return this.isAckRequired()||"EROR"===this.command},this.command,this.payload,this.requestId;var r=this;if(0!==arguments.length){var i;switch(arguments.length){case 1:var a=arguments[0];if(!a||a.length<=4)return r.command="NOOP",void(r.payload="{}");if(a=a.trim(),r.command=a.substring(0,4),r.payload=a.substring(4),r.isRequestIdCommand()){var s=r.getJsonElement();s&&(r.requestId=s.hasOwnProperty("req_id")?s.req_id:"")}break;case 3:i=arguments[2];case 2:var o=arguments[0],l=arguments[1];i=i||"",r.command=o,r.requestId=i,r.requestId||r.isRequestIdCommand()&&(r.requestId=q.generateRequestId()),l.req_id=r.requestId,r.payload=JSON.stringify(l)}}};q.bMessage=function(e,n,t,r,i,a,s,o){var l={};return l.channel_url=e,l.message=n,l.data=t,i&&(l.mention_type=i),l.mentioned_user_ids=[],i===pe.MentionType.CHANNEL?l.mentioned_user_ids=[]:Array.isArray(a)&&a.length>0&&(l.mentioned_user_ids=a),r&&(l.custom_type=r),s.length>0&&(l.target_langs=s),o&&o!==_e.PushNotificationDeliveryOption.DEFAULT&&(l.push_option=o),new q("MESG",l)},q.bRead=function(e){var n={};return n.channel_url=e,new q("READ",n)},q.bTypeStart=function(e,n){var t={};return t.channel_url=e,t.time=n,new q("TPST",t)},q.bTypeEnd=function(e,n){var t={};return t.channel_url=e,t.time=n,new q("TPEN",t)},q.bFile=function(e,n,t,r,i,a,s,o,l,u,c,d,h){var p={};return p.channel_url=n,p.url=t,p.name=r||"",p.type=i||"",p.size=a||0,p.custom=s,o&&(p.custom_type=o),l&&(p.thumbnails=l),u&&(p.require_auth=u),c&&(p.mention_type=c),p.mentioned_user_ids=[],c===pe.MentionType.CHANNEL?p.mentioned_user_ids=[]:Array.isArray(d)&&d.length>0&&(p.mentioned_user_ids=d),h&&h!==fe.PushNotificationDeliveryOption.DEFAULT&&(p.push_option=h),new q("FILE",p,e)},q.bPing=function(){var e={};return e.id=(new Date).getTime(),new q("PING",e)},q.bEnter=function(e){var n={};return n.channel_url=e,new q("ENTR",n)},q.bExit=function(e){var n={};return n.channel_url=e,new q("EXIT",n)},q.bUpdateUserMessage=function(e,n,t,r,i,a,s){var o={};return o.channel_url=e,o.msg_id=n,null!=t&&t!==undefined&&(o.message=t),null!=r&&r!==undefined&&(o.data=r),null!=i&&i!==undefined&&(o.custom_type=i),a&&(o.mention_type=a),o.mentioned_user_ids=[],a===pe.MentionType.CHANNEL?o.mentioned_user_ids=[]:Array.isArray(s)&&s.length>0&&(o.mentioned_user_ids=s),new q("MEDI",o)},q.bUpdateFileMessage=function(e,n,t,r,i,a){var s={};return s.channel_url=e,s.msg_id=n,null!=t&&t!==undefined&&(s.data=t),null!=r&&r!==undefined&&(s.custom_type=r),i&&(s.mention_type=i),s.mentioned_user_ids=[],i===pe.MentionType.CHANNEL?s.mentioned_user_ids=[]:Array.isArray(a)&&a.length>0&&(s.mentioned_user_ids=a),new q("FEDI",s)},q.requestIdSeed=(new Date).getTime(),q.generateRequestId=function(){return q.requestIdSeed++,String(q.requestIdSeed)};var z=function(e){this.isLoading=!1,this.hasNext=!0,this.limit=20;var n="",t=this;this.next=function(r){return t.hasNext?t.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),r):"number"!=typeof t.limit||t.limit<1?void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r):(t.isLoading=!0,void le.getInstance().loadOperatorList(e.url,e.isOpenChannel(),n,t.limit,function(e,i){if(i)return t.isLoading=!1,void O(null,i,r);var a=e;(!(n=String(a.next))||n.length<=0)&&(t.hasNext=!1);var s=a.operators.map(function(e){return new W(e)});t.isLoading=!1,O(s,null,r)})):void O([],null,r)}},J=function(e){this.isLoading=!1,this.hasNext=!0,this.limit=20,this.mutedMemberFilter=J.MUTED_MEMBER_FILTER.ALL,this.operatorFilter=J.OPERATOR_FILTER.ALL,this.memberStateFilter=Y.memberStateFilter.ALL,this.nicknameStartsWithFilter=null;var n=J.Order.MEMBER_NICKNAME_ALPHABETICAL,t="",r=this;this.next=function(i){return r.hasNext?r.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),i):"number"!=typeof r.limit||r.limit<1||"string"!=typeof r.mutedMemberFilter||[J.MUTED_MEMBER_FILTER.ALL,J.MUTED_MEMBER_FILTER.MUTED,J.MUTED_MEMBER_FILTER.UNMUTED].indexOf(r.mutedMemberFilter.toLowerCase())<0||"string"!=typeof r.operatorFilter||[J.OPERATOR_FILTER.ALL,J.OPERATOR_FILTER.OPERATOR,J.OPERATOR_FILTER.NONOPERATOR].indexOf(r.operatorFilter.toLowerCase())<0||"string"!=typeof r.memberStateFilter||[Y.memberStateFilter.ALL,Y.memberStateFilter.JOINED,Y.memberStateFilter.INVITED,Y.memberStateFilter.INVITED_BY_FRIEND,Y.memberStateFilter.INVITED_BY_NON_FRIEND].indexOf(r.memberStateFilter.toLowerCase())<0||null!==r.nicknameStartsWithFilter&&"string"!=typeof r.nicknameStartsWithFilter?void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),i):(r.isLoading=!0,void le.getInstance().loadGroupChannelMemberList(e,t,r.limit,r.mutedMemberFilter,r.operatorFilter,r.memberStateFilter,r.nicknameStartsWithFilter,n,function(e,n){if(n)return r.isLoading=!1,void O(null,n,i);var a=e;(!(t=String(a.next))||t.length<=0)&&(r.hasNext=!1);var s=a.members.map(function(e){return new j(e)});r.isLoading=!1,O(s,null,i)})):void O([],null,i)}};J.MUTED_MEMBER_FILTER={ALL:"all",MUTED:"muted",UNMUTED:"unmuted"},J.OPERATOR_FILTER={ALL:"all",OPERATOR:"operator",NONOPERATOR:"nonoperator"},J.Order={MEMBER_NICKNAME_ALPHABETICAL:"member_nickname_alphabetical"};var Q=function(){this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=Q.ORDER_LATEST_LAST_MESSAGE,this.userIdsFilter=[],this.userIdsFilterExactMatch=!1,this.queryType="AND";var e={userIds:[],includeMode:!0,queryType:Z.USER_IDS_INCLUDE_QUERY_TYPE.AND};this._userIdsExactFilter=[],this._userIdsIncludeFilter=[],this._userIdsIncludeFilterQueryType=Z.USER_IDS_INCLUDE_QUERY_TYPE.AND,d?(this.userIdsExactFilter=this._userIdsExactFilter,this.userIdsIncludeFilter=this._userIdsIncludeFilter,this.userIdsIncludeFilterQueryType=this._userIdsIncludeFilterQueryType):(Object.defineProperty(this,"userIdsExactFilter",{get:function(){return this._userIdsExactFilter},set:function(n){Array.isArray(n)&&(this._userIdsExactFilter=n,this._userIdsIncludeFilter=[],e={userIds:this._userIdsExactFilter,includeMode:!1})}}),Object.defineProperty(this,"userIdsIncludeFilter",{get:function(){return this._userIdsIncludeFilter},set:function(n){Array.isArray(n)&&(this._userIdsIncludeFilter=n,this._userIdsExactFilter=[],e={userIds:this._userIdsIncludeFilter,includeMode:!0})}}),Object.defineProperty(this,"userIdsIncludeFilterQueryType",{get:function(){return this._userIdsIncludeFilterQueryType},set:function(n){this._userIdsIncludeFilterQueryType=n,e={queryType:this._userIdsIncludeFilterQueryType}}})),this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.memberStateFilter=Y.memberStateFilter.ALL,this.customTypeFilter="",this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=Y.superChannelFilter.ALL,this.publicChannelFilter=Y.publicChannelFilter.ALL,this.customTypeStartsWithFilter=null;var n="",t=this;this.next=function(r){if(!t.hasNext)return void O([],null,r);if(t.isLoading)return void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),r);if(null!==t.nicknameContainsFilter&&"undefined"!=typeof t.nicknameContainsFilter||(t.nicknameContainsFilter=""),null!==t.channelNameContainsFilter&&"undefined"!=typeof t.channelNameContainsFilter||(t.channelNameContainsFilter=""),null!==t.customTypeStartsWithFilter&&"string"!=typeof t.customTypeStartsWithFilter)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);if(!Array.isArray(t._userIdsExactFilter)||!Array.isArray(t._userIdsIncludeFilter)||"string"!=typeof t._userIdsIncludeFilterQueryType||[Z.USER_IDS_INCLUDE_QUERY_TYPE.AND,Z.USER_IDS_INCLUDE_QUERY_TYPE.OR].indexOf(t._userIdsIncludeFilterQueryType.toUpperCase())<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);if("number"==typeof t.memberStateFilter){if(typeof t.memberStateFilter<0||typeof t.memberStateFilter>4)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);var i=["all","joined_only","invited_only","invited_by_friend","invited_by_non_friend"];t.memberStateFilter=i[t.memberStateFilter]}if(!_(t.limit)||!Array.isArray(t.userIdsFilter)||"boolean"!=typeof t.includeEmpty||"boolean"!=typeof t.userIdsFilterExactMatch||"string"!=typeof t.customTypeFilter||!Array.isArray(t.customTypesFilter)||"string"!=typeof t.queryType||["AND","OR"].indexOf(t.queryType.toUpperCase())<0||"string"!=typeof t.order||[Q.ORDER_CHRONOLOGICAL,Q.ORDER_LATEST_LAST_MESSAGE,Q.CHANNEL_NAME_ALPHABETICAL].indexOf(t.order.toLowerCase())<0||"string"!=typeof t.memberStateFilter||[Y.memberStateFilter.ALL,Y.memberStateFilter.JOINED,Y.memberStateFilter.INVITED,Y.memberStateFilter.INVITED_BY_FRIEND,Y.memberStateFilter.INVITED_BY_NON_FRIEND].indexOf(t.memberStateFilter.toLowerCase())<0||"string"!=typeof t.nicknameContainsFilter||"string"!=typeof t.channelNameContainsFilter||!Array.isArray(t.channelUrlsFilter)||"string"!=typeof t.superChannelFilter||[Y.superChannelFilter.ALL,Y.superChannelFilter.SUPER,Y.superChannelFilter.NON_SUPER].indexOf(t.superChannelFilter.toLowerCase())<0||"string"!=typeof t.publicChannelFilter||[Y.publicChannelFilter.ALL,Y.publicChannelFilter.PUBLIC,Y.publicChannelFilter.PRIVATE].indexOf(t.publicChannelFilter.toLowerCase())<0)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),r);Array.isArray(t.userIdsFilter)&&t.userIdsFilter.length>0&&(e={userIds:t.userIdsFilter,includeMode:!t.userIdsFilterExactMatch,queryType:t.queryType}),t.isLoading=!0,le.getInstance().loadUserGroupChannelList(n,t.limit,t.includeEmpty,t.order,e,t.nicknameContainsFilter,t.channelNameContainsFilter,t.channelUrlsFilter,t.customTypeFilter,t.customTypesFilter,t.customTypeStartsWithFilter,t.memberStateFilter,t.superChannelFilter,t.publicChannelFilter,function(e,i){if(i)return t.isLoading=!1,void O(null,i,r);var a=e;(!(n=String(a.next))||n.length<=0)&&(t.hasNext=!1);var s=a.channels,o=[];for(var l in s){var u=Y.upsert(s[l]);o.push(u)}t.isLoading=!1,O(o,null,r)})}};Q.ORDER_LATEST_LAST_MESSAGE="latest_last_message",Q.ORDER_CHRONOLOGICAL="chronological",Q.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",Q.MEMBER_STATE_INVITED_ONLY="invited_only",Q.MEMBER_STATE_JOINED_ONLY="joined_only",Q.MEMBER_STATE_ALL="all";var Z=function(){var e="";this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!0,this.order=Z.ORDER_CHRONOLOGICAL,this.channelNameContainsFilter=null,this.channelUrlsFilter=[],this.customTypesFilter=[],this.customTypeStartsWithFilter=null,this.superChannelFilter=Y.superChannelFilter.ALL,this.membershipFilter=Z.MEMBERSHIP_TYPE.JOINED;var n=this;this.next=function(t){return n.hasNext?n.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),t):!_(n.limit)||"boolean"!=typeof n.includeEmpty||!Array.isArray(n.customTypesFilter)||!Array.isArray(n.channelUrlsFilter)||null!==n.channelNameContainsFilter&&"string"!=typeof n.channelNameContainsFilter||null!==n.customTypeStartsWithFilter&&"string"!=typeof n.customTypeStartsWithFilter||"string"!=typeof n.order||[Z.ORDER_CHRONOLOGICAL,Z.ORDER_LATEST_LAST_MESSAGE,Z.CHANNEL_NAME_ALPHABETICAL].indexOf(n.order.toLowerCase())<0?void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t):"string"!=typeof n.superChannelFilter||[Y.superChannelFilter.ALL,Y.superChannelFilter.SUPER,Y.superChannelFilter.NON_SUPER].indexOf(n.superChannelFilter.toLowerCase())<0||"string"!=typeof n.membershipFilter||[Z.MEMBERSHIP_TYPE.ALL,Z.MEMBERSHIP_TYPE.JOINED].indexOf(n.membershipFilter.toLowerCase())<0?void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t):(n.isLoading=!0,void le.getInstance().loadPublicGroupChannelList(e,n.limit,n.includeEmpty,n.order,n.channelNameContainsFilter,n.channelUrlsFilter,n.customTypesFilter,n.customTypeStartsWithFilter,n.superChannelFilter,n.membershipFilter,function(r,i){if(i)return n.isLoading=!1,void O(null,i,t);var a=r;(!(e=String(a.next))||e.length<=0)&&(n.hasNext=!1);var s=a.channels,o=[];for(var l in s){var u=Y.upsert(s[l]);o.push(u)}n.isLoading=!1,O(o,null,t)})):void O([],null,t)}};Z.ORDER_CHRONOLOGICAL="chronological",Z.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",Z.USER_IDS_INCLUDE_QUERY_TYPE={AND:"AND",OR:"OR"},Z.MEMBERSHIP_TYPE={ALL:"all",JOINED:"joined"};var X=function(e){this.isLoading=!1;var n=e,t=this;this.next=function(e,r,i,a){if(t.isLoading)return void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),a);if(4!==arguments.length){if("function"!=typeof a){var s=Array.prototype.slice.call(arguments);"function"==typeof s.slice(-1)[0]&&(a=s.pop())}return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a)}if(!_(e)||!_(r)||"boolean"!=typeof i)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a);t.isLoading=!0,le.getInstance().messageList(n.isOpenChannel(),n.url,e,0,r,!1,i,"","",[],function(e,r){if(r)return t.isLoading=!1,void O(null,r,a);var i=e.messages,s=[];for(var o in i){var l=b.build(i[o],n);l&&s.push(l)}t.isLoading=!1,O(s,null,a)})},this.prev=function(e,r,i,a){if(t.isLoading)return void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),a);if(4!==arguments.length){if("function"!=typeof a){var s=Array.prototype.slice.call(arguments);"function"==typeof s.slice(-1)[0]&&(a=s.pop())}return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a)}if(!_(e)||!_(r)||"boolean"!=typeof i)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a);t.isLoading=!0,le.getInstance().messageList(n.isOpenChannel(),n.url,e,r,0,!1,i,"","",[],function(e,r){if(r)return t.isLoading=!1,void O(null,r,a);var i=e.messages,s=[];for(var o in i){var l=b.build(i[o],n);l&&s.push(l)}t.isLoading=!1,O(s,null,a)})},this.load=function(e,r,i,a,s){if(t.isLoading)return void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),s);if(5!==arguments.length){if("function"!=typeof s){var o=Array.prototype.slice.call(arguments);"function"==typeof o.slice(-1)[0]&&(s=o.pop())}return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),s)}if(!_(e)||!_(r)||!_(i)||"boolean"!=typeof a)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),s);t.isLoading=!0,le.getInstance().messageList(n.isOpenChannel(),n.url,e,r,i,!0,a,"","",[],function(e,r){if(r)return t.isLoading=!1,void O(null,r,s);var i=e.messages,a=[];for(var o in i){var l=b.build(i[o],n);l&&a.push(l)}t.isLoading=!1,O(a,null,s)})}},$=function(){var e="";this.limit=20,this.isLoading=!1,this.hasNext=!0,this.nameKeyword=null,this.urlKeyword=null,this.customType=null;var n=this;this.next=function(t){return this.hasNext?this.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),t):"string"!=typeof n.nameKeyword&&null!==n.nameKeyword||"string"!=typeof n.urlKeyword&&null!==n.urlKeyword||"string"!=typeof n.customType&&null!==n.customType||!_(n.limit)?void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t):(n.isLoading=!0,void le.getInstance().loadOpenChannelList(e,n.limit,n.nameKeyword,n.urlKeyword,n.customType,function(r,i){if(i)return n.isLoading=!1,void O(null,i,t);var a=r;try{e=String(a.next)}catch(n){e=""}e||(n.hasNext=!1);var s=a.channels,o=[];s.forEach(function(e){var n=G.upsert(e);o.push(n)}),n.isLoading=!1,O(o,null,t)})):void O([],null,t)}},ee=function(e){var n=e,t=0x8000000000000000;this.hasMore=!0,this.isLoading=!1;var r=this;this.limit=20,this.reverse=!1,this.messageTypeFilter=null,this.customTypeFilter=null,this.senderUserIdsFilter=[],this.load=function(){var e=null,i=Array.prototype.slice.call(arguments);switch("function"==typeof i.slice(-1)[0]&&(e=i.pop()),i.length){case 2:this.limit=i[0],this.reverse=i[1];break;case 3:this.limit=i[0],this.reverse=i[1],this.messageTypeFilter=i[2]}if(null===this.messageTypeFilter||"undefined"==typeof this.messageTypeFilter||this.messageTypeFilter===E.MessageTypeFilter.ALL?this.messageTypeFilter="":this.messageTypeFilter.toString().toLowerCase()===b.MESSAGE_TYPE_USER||this.messageTypeFilter===E.MessageTypeFilter.USER?this.messageTypeFilter="MESG":this.messageTypeFilter.toString().toLowerCase()===b.MESSAGE_TYPE_FILE||this.messageTypeFilter===E.MessageTypeFilter.FILE?this.messageTypeFilter="FILE":this.messageTypeFilter.toString().toLowerCase()!==b.MESSAGE_TYPE_ADMIN&&this.messageTypeFilter!==E.MessageTypeFilter.ADMIN||(this.messageTypeFilter="ADMM"),!_(this.limit)||"boolean"!=typeof this.reverse||null!==this.messageTypeFilter&&"string"!=typeof this.messageTypeFilter||null!==this.customTypeFilter&&"string"!=typeof this.customTypeFilter||!Array.isArray(this.senderUserIdsFilter))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),e);for(var a=0;a<this.senderUserIdsFilter.length;a++)if("string"!=typeof this.senderUserIdsFilter[a])return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),e);return r.hasMore?r.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),e):(r.isLoading=!0,void le.getInstance().messageList(n.isOpenChannel(),n.url,t,this.limit,0,!1,this.reverse,this.messageTypeFilter,this.customTypeFilter,this.senderUserIdsFilter,function(i,a){if(a)return r.isLoading=!1,void O(null,a,e);var s=i.messages,o=[];for(var l in s){var u=b.build(s[l],n);u&&(o.push(u),u.createdAt<=t&&(t=u.createdAt))}(o.length<=0||o.length<r.limit)&&(r.hasMore=!1),r.isLoading=!1,O(o,null,e)})):void O([],null,e)}},ne=function(e,n){var t,r,i,a="";this.hasNext=!0,this.limit=20,this.isLoading=!1,this.userIds=[],this.metaDataKey="",this.metaDataValues=[];var s=this;switch(n&&(r=n),t=e){case ne.ALL_USER:case ne.BLOCKED_USER:i="users";break;case ne.FILTERED_USER:this.userIds=n,i="users";break;case ne.PARTICIPANT:i="participants";break;case ne.MUTED_USER:i="muted_list";break;case ne.BANNED_USER:i="banned_list"}this.next=function(n){if(!s.hasNext)return void O([],null,n);if(s.isLoading)return void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),n);if(!_(s.limit)||!Array.isArray(s.userIds)||"string"!=typeof s.metaDataKey||!Array.isArray(s.metaDataValues)||s.metaDataKey&&p(s.metaDataValues)||!s.metaDataKey&&!p(s.metaDataValues))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);s.isLoading=!0;var o=function(t,r){if(r)return s.isLoading=!1,void O(null,r,n);(a=t.next)||(s.hasNext=!1);var o=t[i],l=[];for(var u in o)e===ne.BANNED_USER?l.push(new W(o[u].user)):l.push(new W(o[u]));s.isLoading=!1,O(l,null,n)};switch(t){case ne.ALL_USER:le.getInstance().loadUserList(a,s.limit,[],s.metaDataKey,s.metaDataValues,o);break;case ne.FILTERED_USER:le.getInstance().loadUserList(a,s.limit,s.userIds,s.metaDataKey,s.metaDataValues,o);break;case ne.BLOCKED_USER:le.getInstance().loadBlockedUserList(Ee.getInstance().getCurrentUserId(),a,s.limit,o);break;case ne.PARTICIPANT:le.getInstance().loadOpenChannelParticipantList(r.url,a,s.limit,o);break;case ne.MUTED_USER:le.getInstance().loadMutedUserList(r,a,s.limit,o);break;case ne.BANNED_USER:le.getInstance().loadBannedUserList(r,a,s.limit,o)}}};ne.ALL_USER="alluser",ne.FILTERED_USER="filtereduser",ne.BLOCKED_USER="blockeduser",ne.PARTICIPANT="participant",ne.MUTED_USER="muteduser",ne.BANNED_USER="banneduser";var te=function(){};te.INVALID_INITIALIZATION=800100,te.CONNECTION_REQUIRED=800101,te.INVALID_PARAMETER=800110,te.NETWORK_ERROR=800120,te.NETWORK_ROUTING_ERROR=800121,te.MALFORMED_DATA=800130,te.MALFORMED_ERROR_DATA=800140,te.WRONG_CHANNEL_TYPE=800150,te.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160,te.QUERY_IN_PROGRESS=800170,te.ACK_TIMEOUT=800180,te.LOGIN_TIMEOUT=800190,te.WEBSOCKET_CONNECTION_CLOSED=800200,te.WEBSOCKET_CONNECTION_FAILED=800210,te.REQUEST_FAILED=800220,te.FILE_UPLOAD_CANCEL_FAILED=800230,te.REQUEST_CANCELLED=800240;var re=15e3,ie=5e3,ae=function(){var e,r,i=function(){t&&n.log("PING");var e=q.bPing();Ee.getInstance().wsClient.send(e),r=setTimeout(function(){t&&n.log("PING Timeout"),a(),Ee.getInstance().wsClient._WSClientOnError()},ie)};this.pong=function(){clearTimeout(r),r=null},this.start=function(){this.stop(),i(),e=setInterval(function(){i()},re)};var a=function(){clearInterval(e),e=null,clearTimeout(r),r=null};this.stop=function(){a()}},se=new ae,oe=function(e){var r,i,a=!1,s=0,l=e;l||(l=new oe.WSClientHandler);var u=function(){s=(new Date).getTime()};this._WSClientOnError=function(){l&&l.onError()},this.getConnectionState=function(){try{return 1===r.readyState?Ee.getInstance().connectionState.OPEN:0===r.readyState?Ee.getInstance().connectionState.CONNECTING:Ee.getInstance().connectionState.CLOSED}catch(e){return Ee.getInstance().connectionState.CLOSED}},this.connect=function(e,s,c){t&&n.log("WSClient connect called"),i=c;var d=null,h=!1;try{d="undefined"==typeof WebSocket?require("ws"):WebSocket}catch(e){d=WebSocket}try{var p="/?p=JS&pv="+encodeURIComponent(o)+"&sv="+encodeURIComponent("3.0.77")+"&ai="+encodeURIComponent(L);if(le.getInstance().sessionKey?p+="&key="+encodeURIComponent(le.getInstance().sessionKey):p+="&user_id="+encodeURIComponent(e)+"&access_token="+encodeURIComponent(s),!(r=new d(i+p)))return Ee.getInstance().isReconnectingOnError=!0,void l.onError("ws is not exist.")}catch(e){return Ee.getInstance().isReconnectingOnError=!0,void l.onError(e)}if(t)try{window.ws=r}catch(e){}r.onopen=function(e){se&&se.start(),t&&n.log("WSClient onopen called"),l.onOpen(e)},r.onmessage=function(e){u();var r=e.data.split("\n");for(var i in r){var a=r[i];if(a&&"string"==typeof a){try{if("PONG"===a.substring(0,4)){se.pong();continue}}catch(e){t&&n.log("ws.onmessage-command check error: ",e)}l.onMessage(a)}}},r.onclose=function(e){t&&n.log("WSClient ws.onclose called - e, explicitDisconnect: ",e,a),se&&se.stop(),a?l.onClose(e):h||l.onError(e),a=!1},r.onerror=function(e){t&&n.log("WSClient ws.onerror called: ",e),se&&se.stop(),h=!0,Ee.getInstance().isReconnectingOnError=!0,l.onError(e)}},this.disconnect=function(e,i){t&&n.log("WSClient disconnect called [explicit]: ",e),se&&se.stop(),a=!0===e,r&&(r.onopen=function(){},r.onmessage=function(){},r.onclose=function(){i&&i()},r.onerror=function(){},r.close(),r=null),a?l.onClose():l.onError(),a=!1},this.send=function(e,n){1!==r.readyState?n&&n(null,new I("Connection is not valid. Please reconnect.",te.WEBSOCKET_CONNECTION_CLOSED)):(r.send(e.encode()),n&&n(null,null))}};oe.WSClientHandler=function(){this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onMessage=function(){},this.onError=function(){}};var le=function(){var e=le.getInstance();if(e)return e;this.sessionKey;this.getMessageChangeLogsByToken=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o="";o=e?le.API_OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(n));var l={};t&&(l.token=t),i(o,l,r)})},this.setChannelInvitationPreference=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(t.userId));s(i,{auto_accept:e},n)})},this.getChannelInvitationPreference=function(e){Ee.getInstance().ConnectionManager.ready(function(n,t){if(t)return void e(null,t);var r=le.API_USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(n.userId));i(r,e)})},this.getGroupChannelCount=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var a=le.API_USERS_USERID_GROUP_CHANNEL_COUNT.replace("%s",encodeURIComponent(t.userId)),s="";s=e===Y.memberState.JOINED?"joined":e===Y.memberState.INVITED?"invited":e===Y.memberState.INVITED_BY_FRIEND?"invited_by_friend":e===Y.memberState.INVITED_BY_NON_FRIEND?"invited_by_non_friend":"all",i(a,{state:s},n)})},this.getUnreadItemCount=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var a=le.API_USERS_USERID_UNREAD_ITEM_COUNT.replace("%s",encodeURIComponent(t.userId)),s={item_keys:e.join(",")};i(a,s,n)})},this.getTotalUnreadMessageCount=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void t(null,s);var o=le.API_USERS_USERID_UNREAD_MESSAGE_COUNT.replace("%s",encodeURIComponent(a.userId)),l=null;null!==e&&e.length>0&&(l=r(e));var u={super_mode:n};l&&(u.custom_types=l),i(o,u,t)})},this.getTotalUnreadChannelCount=function(e){Ee.getInstance().ConnectionManager.ready(function(n,t){if(t)return void e(null,t);var r=le.API_USERS_USERID_UNREAD_CHANNEL_COUNT.replace("%s",encodeURIComponent(n.userId));i(r,e)})},this.checkRouting=function(e){Ee.getInstance()&&Ee.getInstance().customApiHost&&Ee.getInstance().customWsHost?"function"==typeof e&&e({API_HOST:Ee.getInstance().customApiHost,WS_HOST:Ee.getInstance().customWsHost}):e({API_HOST:le.API_ROUTING_URL.replace("%s",L),WS_HOST:"wss://ws-%s.sendbird.com".replace("%s",L)},null)};var n=function(e,n,t,r,i,a,s,o,c,d){le.getInstance().checkRouting(function(n,p){if(p)s(null,new I("Request failed.",te.REQUEST_FAILED));else{var _=S();_.open("POST",n.API_HOST+e,!0),_.setRequestHeader("SendBird",u+L),_.setRequestHeader("Session-Key",le.getInstance().sessionKey);var f=l?new l:new FormData;r&&"undefined"!=typeof Blob&&(t instanceof Blob||"string"==typeof t||Array.isArray(t)||t.hasOwnProperty("isRNFetchBlobPolyfill"))?f.append("file",new Blob([t],{type:r}),t.name):f.append("file",t,t.name),a&&f.append("channel_url",a);for(var E in i){var g=parseInt(E)+1;f.append("thumbnail"+g,i[E].maxWidth+","+i[E].maxHeight)}_.onload=function(){c&&c[d]&&delete c[d];_.status>=200&&_.status<400?h(null,JSON.parse(_.responseText),s):h({status:_.status,statusText:_.statusText,response:_.responseText},null,s)},_.onerror=function(e){c&&c[d]&&delete c[d],s(null,new I(_.statusText,te.REQUEST_FAILED))},_.onabort=function(e){c&&c[d]&&delete c[d],s(null,new I("File upload has been cancelled.",te.REQUEST_CANCELLED))},_.upload.onprogress=function(e){e.lengthComputable&&e.loaded>=e.total&&c&&c[d]&&delete c[d],o&&o(e)},f.oldIE?(_.setRequestHeader("Content-Type","multipart/form-data; boundary="+f.boundary),_.send(f.toString())):_.send(f),c&&(c[d]=_)}})},t=function(e,n,t){"function"==typeof n&&(t=n,n={}),le.getInstance().checkRouting(function(r,i){i?t(null,new I("Request failed.",te.REQUEST_FAILED)):T(r.API_HOST+e,n,"DELETE",{"Session-Key":le.getInstance().sessionKey,SendBird:u+L},t)})},r=function(e){var n="";for(var t in e)e.hasOwnProperty(t)&&(n+=encodeURIComponent(e[t])+",");return n.length>1&&(n=n.substring(0,n.length-1)),n},i=function(e,n,t){"function"==typeof n&&(t=n,n={});var r,i="";if(n){for(var a in n)""!==i&&(i+="&"),i+=a+"="+n[a];r=e+"?"+i}else r=e;le.getInstance().checkRouting(function(e,i){i?t(null,new I("Request failed.",te.REQUEST_FAILED)):T(e.API_HOST+r,n,"GET",{"Session-Key":le.getInstance().sessionKey,SendBird:u+L},t)})},a=function(e,n,t){"function"==typeof n&&(t=n,n={}),le.getInstance().checkRouting(function(r,i){i?t(null,i):T(r.API_HOST+e,n,"POST",{"Session-Key":le.getInstance().sessionKey,SendBird:u+L},t)})},s=function(e,n,t){"function"==typeof n&&(t=n,n={}),le.getInstance().checkRouting(function(r,i){i||T(r.API_HOST+e,n,"PUT",{"Session-Key":le.getInstance().sessionKey,SendBird:u+L},t)})};this.addFriends=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_FRIENDS.replace("%s",encodeURIComponent(t.userId));a(i,{user_ids:e},n)})},this.deleteFriends=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_FRIENDS.replace("%s",encodeURIComponent(r.userId));e.length>0&&(a+="?user_ids=",e.forEach(function(e){a+=encodeURIComponent(e)+","}),a=a.substring(0,a.length-1)),t(a,{},n)})},this.deleteFriendDiscoveries=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(r.userId));e.length>0&&(a+="?friend_discovery_keys=",e.forEach(function(e){a+=encodeURIComponent(e)+","}),a=a.substring(0,a.length-1)),t(a,{},n)})},this.uploadFriendDiscoveries=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(t.userId)),a={friend_discoveries:[]};e.forEach(function(e){a.friend_discoveries.push({friend_discovery_key:e.friendDiscoveryKey,friend_name:"string"==typeof e.friendName||e.friendName?e.friendName:null})}),s(i,a,n)})},this.getFriendChangeLogsByToken=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var a=le.API_FRIENDS_CHANGE_LOGS.replace("%s",encodeURIComponent(t.userId)),s={};e&&(s.token=e),i(a,s,n)})},this.friendListQuery=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,a){if(a)return void t(null,a);var s=le.API_FRIENDS.replace("%s",encodeURIComponent(r.userId)),o={limit:n,token:encodeURIComponent(e)};i(s,o,t)})},this.createUserMetaData=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_METADATA.replace("%s",encodeURIComponent(t.userId)),s={};s.metadata=e,a(i,s,n)})},this.updateUserMetaData=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var a=le.API_USERS_USERID_METADATA.replace("%s",encodeURIComponent(r.userId)),o={};o.metadata=e,o.upsert=n,s(a,o,t)})},this.deleteAllUserMetaData=function(e){Ee.getInstance().ConnectionManager.ready(function(n,r){if(r)return void e(null,r);var i=le.API_USERS_USERID_METADATA.replace("%s",encodeURIComponent(n.userId));t(i,{},e)})},this.deleteUserMetaData=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_USERS_USERID_METADATA_KEY.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e));t(a,{},n)})},this.resetMyHistory=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_RESET_USER_HISTORY.replace("%s",encodeURIComponent(e));s(i,{},n)})},this.groupChannelInvite=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var s=le.API_GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(e)),o={},l=[];try{Array.isArray(n)?l=n:l.push(n)}catch(e){t(null,new I("Invalid parameter.",te.INVALID_PARAMETER))}o.user_ids=l,a(s,o,t)})},this.acceptInvitation=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION.replace("%s",encodeURIComponent(e)),a={};a.user_id=t.userId,s(i,a,n)})},this.declineInvitation=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION.replace("%s",encodeURIComponent(e)),a={};a.user_id=t.userId,s(i,a,n)})},this.groupChannelHide=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var a=le.API_GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(e)),o={};o.user_id=r.userId,o.hide_previous_messages=n,s(a,o,t)})},this.publicGroupChannelJoin=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_CHANNELURL_JOIN.replace("%s",encodeURIComponent(e)),a={};a.user_id=t.userId,s(i,a,n)})},this.groupChannelLeave=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(e)),a={};a.user_id=t.userId,s(i,a,n)})},this.groupChannelMarkAsRead=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD.replace("%s",encodeURIComponent(e)),a={};a.user_id=t.userId,
s(i,a,n)})},this.groupChannelMarkAsReadAll=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(t.userId)),a={};e&&(a.channel_urls=e),s(i,a,n)})},this.messageList=function(e,n,t,a,s,o,l,u,c,d,h){Ee.getInstance().ConnectionManager.ready(function(p,_){if(_)return void h(null,_);var f;f=e?String(le.API_OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",n)):String(le.API_GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",n));var I={};I.is_sdk=String(!0),I.message_ts=String(t),I.prev_limit=String(a),I.next_limit=String(s),I.include=String(o),I.reverse=String(l),u&&(I.message_type=String(u)),c&&(I.custom_type=String(c)),d.length>0&&(I.sender_ids=r(d)),i(f,I,h)})},this.messageListByID=function(e,n,t,a,s,o,l,u,c,d,h){Ee.getInstance().ConnectionManager.ready(function(p,_){if(_)return void h(null,_);var f;f=e?String(le.API_OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",n)):String(le.API_GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",n));var I={};I.is_sdk=String(!0),I.message_id=t,I.prev_limit=String(a),I.next_limit=String(s),I.include=String(o),I.reverse=String(l),u&&(I.message_type=String(u)),c&&(I.custom_type=String(c)),d.length>0&&(I.sender_ids=r(d)),i(f,I,h)})},this.updateUserInfo=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var a={};e&&(a.nickname=e),n&&(a.profile_url=n);var o=String(le.API_USERS_USERID).replace("%s",encodeURIComponent(r.userId));s(o,a,t)})},this.updateCurrentUserInfoWithFile=function(e,n,t){var r=this;Ee.getInstance().ConnectionManager.ready(function(i,a){if(a)return void t(null,a);if("string"==typeof n)r.updateUserInfo(i.userId,e,n,t);else{var o=l?new l:new FormData;o.append("nickname",e),o.append("profile_file",n,n.name);var u=String(le.API_USERS_USERID).replace("%s",encodeURIComponent(i.userId));s(u,o,t)}})},this.getGroupChannel=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o=le.API_GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e)),l={member:String(n),read_receipt:String(t)};i(o,l,r)})},this.getOpenChannel=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var a=le.API_OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e));i(a,n)})},this.createGroupChannel=function(e,n,t,r,i,s,o,u,c,d,h){Ee.getInstance().ConnectionManager.ready(function(p,_){if(_)return void h(null,_);var f=le.API_GROUPCHANNELS,I=[];"string"==typeof e?I.push(e):e.forEach(function(e){I.push(e)}),I.push(p.userId);var E,g=I.filter(function(e,n){return I.indexOf(e)===n}),m=u.isPublic,A=u.channelUrl;r&&"string"!=typeof r?(E=l?new l:new FormData,r&&E.append("cover_file",r,r.name),E.append("user_ids",g),null!==A&&E.append("channel_url",A),null!==n&&E.append("is_distinct",n),null!==o&&E.append("is_super",o),null!==m&&E.append("is_public",m),null!==d&&E.append("is_ephemeral",d),null!==t&&"string"==typeof t&&E.append("name",t),i&&E.append("data",i),s&&E.append("custom_type",s),Array.isArray(c)&&c.length>0&&E.append("operator_ids",c)):(E={},null!==r&&"string"==typeof r&&(E.cover_url=r),E.user_ids=g,null!==A&&(E.channel_url=A),null!==n&&(E.is_distinct=n),null!==o&&(E.is_super=o),null!==m&&(E.is_public=m),null!==d&&(E.is_ephemeral=d),null!==t&&"string"==typeof t&&(E.name=t),i&&(E.data=i),s&&(E.custom_type=s),Array.isArray(c)&&c.length>0&&(E.operator_ids=c)),a(f,E,h)})},this.createOpenChannel=function(e,n,t,r,i,s){Ee.getInstance().ConnectionManager.ready(function(o,u){if(u)return void s(null,u);var c,d=String(le.API_OPENCHANNELS);n&&"string"!=typeof n?(c=l?new l:new FormData,n&&c.append("cover_file",n,n.name),null!==e&&"string"==typeof e&&c.append("name",e),t&&c.append("data",t),r&&(Array.isArray(r)?c.append("operators",r):c.append("operators",[r])),i&&c.append("custom_type",i)):(c={},null!==n&&"string"==typeof n&&(c.cover_url=n),null!==e&&"string"==typeof e&&(c.name=e),t&&(c.data=t),r&&(Array.isArray(r)?c.operators=r:c.operators=[r]),i&&(c.custom_type=i)),a(d,c,s)})},this.updateGroupChannel=function(e,n,t,r,i,a,o,u){Ee.getInstance().ConnectionManager.ready(function(c,d){if(d)return void u(null,d);var h,p=String(le.API_GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e)));r&&"string"!=typeof r?(h=l?new l:new FormData,null!==n&&h.append("is_distinct",n),null!==o&&h.append("is_public",o),r&&h.append("cover_file",r,r.name),null!==t&&"string"==typeof t&&h.append("name",t),null!==i&&"string"==typeof i&&h.append("data",i),null!==a&&"string"==typeof a&&h.append("custom_type",a)):(h={},null!==n&&(h.is_distinct=n),null!==o&&(h.is_public=o),null!==r&&"string"==typeof r&&(h.cover_url=r),null!==t&&"string"==typeof t&&(h.name=t),null!==i&&"string"==typeof i&&(h.data=i),null!==a&&"string"==typeof a&&(h.custom_type=a)),s(p,h,u)})},this.updateOpenChannel=function(e,n,t,r,i,a,o){Ee.getInstance().ConnectionManager.ready(function(u,c){if(c)return void o(null,c);var d,h=String(le.API_OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e)));t&&"string"!=typeof t?(d=l?new l:new FormData,t&&d.append("cover_file",t,t.name),null!==n&&"string"==typeof n&&d.append("name",n),null!==r&&"string"==typeof r&&d.append("data",r),null!==i&&(Array.isArray(i)?d.append("operators",i):d.append("operators",[i])),null!==a&&"string"==typeof a&&d.append("custom_type",a)):(d={},null!==t&&"string"==typeof t&&(d.cover_url=t),null!==n&&"string"==typeof n&&(d.name=n),null!==r&&"string"==typeof r&&(d.data=r),null!==i&&(Array.isArray(i)?d.operators=i:d.operators=[i]),null!==a&&"string"==typeof a&&(d.custom_type=a)),s(h,d,o)})},this.deleteOpenChannel=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=String(le.API_OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e)));t(a,{},n)})},this.createMetaCounters=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(i,s){if(s)return void r(null,s);var o;o=e?le.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var l={};l.metacounter=t,a(o,l,r)})},this.updateMetaCounters=function(e,n,t,r,i,a){Ee.getInstance().ConnectionManager.ready(function(o,l){if(l)return void a(null,l);var u;u=e?le.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var c={};switch(c.metacounter=t,c.upsert=r,i){case le.UPDATE_META_COUNTER_MODE_SET:c.mode="set";break;case le.UPDATE_META_COUNTER_MODE_INC:c.mode="increase";break;case le.UPDATE_META_COUNTER_MODE_DEC:c.mode="decrease"}s(u,c,a)})},this.getAllMetaCounters=function(e,n,t){this.getMetaCounters(e,n,{},t)},this.getMetaCounters=function(e,n,t,a){Ee.getInstance().ConnectionManager.ready(function(s,o){if(o)return void a(null,o);var l;l=e?le.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var u=r(t);i(l,{keys:u},a)})},this.deleteMetaCounter=function(e,n,r,i){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void i(null,s);var o="";o=e?le.API_OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r):le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r),t(o,{},i)})},this.deleteAllMetaCounters=function(e,n,r){Ee.getInstance().ConnectionManager.ready(function(i,a){if(a)return void r(null,a);var s="";s=e?le.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)),t(s,{},r)})},this.createMetaData=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(i,s){if(s)return void r(null,s);var o="";o=e?le.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var l={},u={};for(var c in t){var d=t[c];u[c]=d}l.metadata=u,a(o,l,r)})},this.updateMetaData=function(e,n,t,r,i){Ee.getInstance().ConnectionManager.ready(function(a,o){if(o)return void i(null,o);var l="";l=e?le.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var u={},c={};for(var d in t){var h=t[d];c[d]=h}u.metadata=c,u.upsert=r,s(l,u,i)})},this.getAllMetaData=function(e,n,t){this.getMetaData(e,n,{},t)},this.getMetaData=function(e,n,t,a){Ee.getInstance().ConnectionManager.ready(function(s,o){if(o)return void a(null,o);var l="";l=e?le.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var u=r(t);i(l,{keys:u},a)})},this.deleteMetaData=function(e,n,r,i){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void i(null,s);var o="";o=e?le.API_OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r):le.API_GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r),t(o,{},i)})},this.deleteAllMetaData=function(e,n,r){Ee.getInstance().ConnectionManager.ready(function(i,a){if(a)return void r(null,a);var s="";s=e?le.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):le.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)),t(s,{},r)})},this.loadUserList=function(e,n,t,r,a,s){Ee.getInstance().ConnectionManager.ready(function(o,l){if(l)return void s(null,l);var u=le.API_USERS,c={token:encodeURIComponent(e),limit:String(n)};if(!p(t))try{var d="";for(var h in t){var _=t[h];d+=encodeURIComponent(_)+","}d.length>1&&(d=d.substring(0,d.length-1)),c.user_ids=d}catch(e){}if(r&&!p(a)){var f="";a.forEach(function(e){f+=encodeURIComponent(e)+","}),f.length>0&&(f=f.substring(0,f.length-1)),c.metadatakey=encodeURIComponent(r),c.metadatavalues_in=f}i(u,c,s)})},this.loadBlockedUserList=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o=le.API_USERS_USERID_BLOCK.replace("%s",encodeURIComponent(e)),l={token:encodeURIComponent(n),limit:String(t)};i(o,l,r)})},this.loadOpenChannelList=function(e,n,t,r,a,s){Ee.getInstance().ConnectionManager.ready(function(o,l){if(l)return void s(null,l);var u=le.API_OPENCHANNELS,c={token:encodeURIComponent(e),limit:String(n)};null!==t&&(c.name_contains=encodeURIComponent(t)),r&&(c.url_contains=encodeURIComponent(r)),null!==a&&(c.custom_type=encodeURIComponent(a)),i(u,c,s)})},this.sendFileMessage=function(e,n,t,r,i,s,o,l,u,c,d,h,p){Ee.getInstance().ConnectionManager.ready(function(_,f){if(f)return void p(null,f);var I=e.isOpenChannel()?le.API_OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(e.url)):le.API_GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(e.url)),E={message_type:"FILE",user_id:_.userId,url:n,mention_type:c,mentioned_user_ids:[]};null!==t&&void 0!==t&&(E.file_name=t),null!==r&&void 0!==r&&(E.file_size=r),null!==i&&void 0!==i&&(E.file_type=i),null!==s&&void 0!==s&&(E.custom_field=s),null!==o&&void 0!==o&&(E.custom_type=o),l&&(E.thumbnails=l),u&&(E.require_auth=u),c===pe.MentionType.CHANNEL?E.mentioned_user_ids=[]:Array.isArray(d)&&d.length>0&&(E.mentioned_user_ids=d),h&&h!==fe.PushNotificationDeliveryOption.DEFAULT&&(E.push_option=h),a(I,E,p)},!0)},this.uploadFile=function(e,t,r,i,a,s,o,l){Ee.getInstance().ConnectionManager.ready(function(u,c){if(c)return void a(null,c);n(le.API_STORAGE_FILE,0,e,t,r,i,a,s,o,l)})},this.uploadProfileImage=function(e,t){n(le.API_STORAGE_PROFILE,0,e,"",[],"",t)},this.loadOperatorList=function(e,n,t,r,a){Ee.getInstance().ConnectionManager.ready(function(s,o){if(o)return void a(null,o);var l=n?le.API_OPENCHANNELS_OPERATORS.replace("%url",encodeURIComponent(e)):le.API_GROUPCHANNELS_OPERATORS.replace("%url",encodeURIComponent(e)),u={token:encodeURIComponent(t),limit:r};i(l,u,a)})},this.loadGroupChannelMemberList=function(e,n,t,r,a,s,o,l,u){Ee.getInstance().ConnectionManager.ready(function(c,d){if(d)return void u(null,d);var h=le.API_GROUPCHANNELS_MEMBERS.replace("%url",encodeURIComponent(e)),p={token:encodeURIComponent(n),limit:t,muted_member_filter:r.toLowerCase(),operator_filter:a.toLowerCase(),member_state_filter:s,order:l.toLowerCase()};o&&(p.nickname_startswith=encodeURIComponent(o)),i(h,p,u)})},this.loadPublicGroupChannelList=function(e,n,t,r,a,s,o,l,u,c,d){Ee.getInstance().ConnectionManager.ready(function(h,p){if(p)return void d(null,p);var _=le.API_GROUPCHANNELS,f={public_mode:Y.publicChannelFilter.PUBLIC,token:encodeURIComponent(e),limit:String(n),show_member:!0,show_read_receipt:!0,show_empty:String(t),order:r};if(a)try{f.name_contains=encodeURIComponent(a)}catch(e){}if(s.length>0)try{f.channel_urls=s.map(function(e){return encodeURIComponent(e)}).join(",")}catch(e){}if(o.length>0){var I="";o.forEach(function(e){I+=encodeURIComponent(e)+","}),I=I.substring(0,I.length-1),f.custom_types=I}l&&(f.custom_type_startswith=encodeURIComponent(l)),f.super_mode=u,f.public_membership_mode=c,i(_,f,d)})},this.loadUserGroupChannelList=function(e,n,t,a,s,o,l,u,c,d,h,p,_,f,I){Ee.getInstance().ConnectionManager.ready(function(E,g){if(g)return void I(null,g);var m=le.API_MYGROUPCHANNELS.replace("%s",encodeURIComponent(E.userId)),A=s.userIds,v=!s.includeMode,C=s.queryType,N={token:encodeURIComponent(e),limit:String(n),show_member:!0,show_read_receipt:!0,show_empty:String(t),order:a,member_state_filter:p};if(d.length>0){var y="";d.forEach(function(e){y+=encodeURIComponent(e)+","}),y=y.substring(0,y.length-1),N.custom_types=y}else c&&(N.custom_type=encodeURIComponent(c));if(o)try{N.members_nickname_contains=encodeURIComponent(o)}catch(e){}if(l)try{N.name_contains=encodeURIComponent(l)}catch(e){}if(A.length>0)try{v?N.members_exactly_in=r(A):(N.members_include_in=r(A),N.query_type=C)}catch(e){}if(u.length>0)try{N.channel_urls=u.map(function(e){return encodeURIComponent(e)}).join(",")}catch(e){}N.super_mode=_,N.public_mode=f,h&&(N.custom_type_startswith=encodeURIComponent(h)),i(m,N,I)})},this.loadOpenChannelParticipantList=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o=le.API_OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",e),l={token:encodeURIComponent(n),limit:String(t)};i(o,l,r)})},this.loadMutedUserList=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o=e.isOpenChannel()?le.API_OPENCHANNELS_CHANNELURL_MUTE.replace("%s",e.url):le.API_GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",e.url),l={token:encodeURIComponent(n),limit:String(t)};i(o,l,r)})},this.loadBannedUserList=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void r(null,s);var o=e.isOpenChannel()?le.API_OPENCHANNELS_CHANNELURL_BAN.replace("%s",e.url):le.API_GROUPCHANNELS_CHANNELURL_BAN.replace("%s",e.url),l={token:encodeURIComponent(n),limit:String(t)};i(o,l,r)})},this.setPushTemplate=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(t.userId));s(i,{name:e},n)})},this.getPushTemplate=function(e){Ee.getInstance().ConnectionManager.ready(function(n,t){if(t)return void e(null,t);var r=le.API_USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(n.userId));i(r,e)})},this.setDoNotDisturb=function(e,n,t,r,i,a,o){Ee.getInstance().ConnectionManager.ready(function(l,u){if(u)return void o(null,u);var c=le.API_USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(l.userId));s(c,{do_not_disturb:e,start_hour:n,start_min:t,end_hour:r,end_min:i,timezone:a},o)})},this.getDoNotDisturb=function(e){Ee.getInstance().ConnectionManager.ready(function(n,t){if(t)return void e(null,t);var r=le.API_USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId));i(r,e)})},this.setPushPreference=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var a=le.API_USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e)),o={};o.enable=n,s(a,o,t)})},this.getPushPreference=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var a=le.API_USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(t.userId)).replace("%s",encodeURIComponent(e));i(a,n)})},this.setCountPreference=function(e,n,t){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void t(null,i);var a=le.API_USERS_COUNT_PREFERENCE.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e)),o={};o.count_preference=n,s(a,o,t)})},this.registerGCMPushToken=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(t.userId));a(i,{gcm_reg_token:e},n)})},this.unregisterGCMPushToken=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e));t(a,n)})},this.unregisterGCMPushTokenAll=function(e){Ee.getInstance().ConnectionManager.ready(function(n,r){if(r)return void e(null,r);var i=le.API_USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(n.userId));t(i,e)})},this.registerAPNSPushToken=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(t.userId));a(i,{apns_device_token:e},n)})},this.unregisterAPNSPushToken=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e));t(a,n)})},this.unregisterAPNSPushTokenAll=function(e){Ee.getInstance().ConnectionManager.ready(function(n,r){if(r)return void e(null,r);var i=le.API_USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(n.userId));t(i,e)})},this.unregisterPushTokenAll=function(e){Ee.getInstance().ConnectionManager.ready(function(n,r){if(r)return void e(null,r);var i=le.API_USERS_USERID_PUSH.replace("%s",encodeURIComponent(n.userId));t(i,e)})},this.blockUser=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void n(null,r);var i=le.API_USERS_USERID_BLOCK.replace("%s",encodeURIComponent(t.userId));a(i,{target_id:e},n)})},this.unblockUser=function(e,n){Ee.getInstance().ConnectionManager.ready(function(r,i){if(i)return void n(null,i);var a=le.API_USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(r.userId)).replace("%s",encodeURIComponent(e));t(a,{},n)})},this.banUser=function(e,n,t,r,i,s){Ee.getInstance().ConnectionManager.ready(function(o,l){if(l)return void s(null,l);var u=i?le.API_GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(e)):le.API_OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(e)),c={user_id:n};t&&(c.description=t),c.seconds=String(r),a(u,c,s)})},this.unbanUser=function(e,n,r,i){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void i(null,s);var o=r?le.API_GROUPCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n)):le.API_OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));t(o,{},i)})},this.muteUser=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(i,s){if(s)return void r(null,s);var o=t?le.API_GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(e)):le.API_OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(e));a(o,{user_id:n},r)})},this.unmuteUser=function(e,n,r,i){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void i(null,s);var o=r?le.API_GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n)):le.API_OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));t(o,{},i)})},this.deleteMessage=function(e,n,r,i){Ee.getInstance().ConnectionManager.ready(function(a,s){if(s)return void i(null,s);var o="";o=e?le.API_OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(n)).replace("%s",encodeURIComponent(r)):le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(n)).replace("%s",encodeURIComponent(r)),t(o,{},i)})},this.freeze=function(e,n,t,r){Ee.getInstance().ConnectionManager.ready(function(i,a){if(a)return void r(null,a);var o=n?le.API_GROUPCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(e)):le.API_OPENCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(e));s(o,{freeze:t},r)})}},ue=null;le.getInstance=function(){return null===ue?null:ue},le.API_VERSION="v3",le.API_ROUTING_URL="https://api-%s.sendbird.com",le.API_USERS="/%v/users".replace("%v",le.API_VERSION),le.API_USERS_USERID_LOGIN="/%v/users/%s/login".replace("%v",le.API_VERSION),le.API_USERS_USERID="/%v/users/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_UNREAD_ITEM_COUNT="/%v/users/%s/unread_item_count".replace("%v",le.API_VERSION),le.API_USERS_USERID_METADATA="/%v/users/%s/metadata".replace("%v",le.API_VERSION),le.API_USERS_USERID_METADATA_KEY="/%v/users/%s/metadata/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_UNREAD_MESSAGE_COUNT="/%v/users/%s/unread_message_count".replace("%v",le.API_VERSION),le.API_USERS_USERID_UNREAD_CHANNEL_COUNT="/%v/users/%s/unread_channel_count".replace("%v",le.API_VERSION),le.API_USERS_USERID_MARKASREADALL="/%v/users/%s/mark_as_read_all".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH_GCM_TOKEN="/%v/users/%s/push/gcm/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH_GCM="/%v/users/%s/push/gcm".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSHPREFERENCE_CHANNELURL="/%v/users/%s/push_preference/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSHPREFERENCE="/%v/users/%s/push_preference/".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH_TEMPLATE="/%v/users/%s/push/template".replace("%v",le.API_VERSION),le.API_USERS_USERID_BLOCK="/%v/users/%s/block".replace("%v",le.API_VERSION),le.API_USERS_USERID_BLOCK_TARGETID="/%v/users/%s/block/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH_APNS_TOKEN="/%v/users/%s/push/apns/%s".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH_APNS="/%v/users/%s/push/apns".replace("%v",le.API_VERSION),le.API_USERS_USERID_PUSH="/%v/users/%s/push".replace("%v",le.API_VERSION),le.API_USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE="/%v/users/%s/channel_invitation_preference".replace("%v",le.API_VERSION),le.API_USERS_USERID_GROUP_CHANNEL_COUNT="/%v/users/%s/group_channel_count".replace("%v",le.API_VERSION),le.API_USERS_COUNT_PREFERENCE="/%v/users/%s/count_preference/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS="/%v/open_channels".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL="/%v/open_channels/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_MESSAGES="/%v/open_channels/%s/messages".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID="/%v/open_channels/%s/messages/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_PARTICIPANTS="/%v/open_channels/%s/participants".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_METADATA="/%v/open_channels/%s/metadata".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_METADATA_KEY="/%v/open_channels/%s/metadata/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_METACOUNTER="/%v/open_channels/%s/metacounter".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_METACOUNTER_KEY="/%v/open_channels/%s/metacounter/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_BAN="/%v/open_channels/%s/ban".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_BAN_USERID="/%v/open_channels/%s/ban/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_MUTE="/%v/open_channels/%s/mute".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_MUTE_USERID="/%v/open_channels/%s/mute/%s".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_FREEZE="/%v/open_channels/%s/freeze".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS="/%v/group_channels".replace("%v",le.API_VERSION),le.API_MYGROUPCHANNELS="/%v/users/%s/my_group_channels".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL="/%v/group_channels/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_INVITE="/%v/group_channels/%s/invite".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION="/%v/group_channels/%s/accept".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION="/%v/group_channels/%s/decline".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_HIDE="/%v/group_channels/%s/hide".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_LEAVE="/%v/group_channels/%s/leave".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_JOIN="/%v/group_channels/%s/join".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES="/%v/group_channels/%s/messages".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD="/%v/group_channels/%s/messages/mark_as_read".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT="/%v/group_channels/%s/messages/total_count".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT="/%v/group_channels/%s/messages/unread_count".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID="/%v/group_channels/%s/messages/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MEMBERS="/%v/group_channels/%s/members".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_METADATA="/%v/group_channels/%s/metadata".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_METADATA_KEY="/%v/group_channels/%s/metadata/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER="/%v/group_channels/%s/metacounter".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY="/%v/group_channels/%s/metacounter/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_RESET_USER_HISTORY="/%v/group_channels/%s/reset_user_history".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_MEMBERS="/%v/group_channels/%url/members".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_BAN="/%v/group_channels/%s/ban".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_BAN_USERID="/%v/group_channels/%s/ban/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MUTE="/%v/group_channels/%s/mute".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MUTE_USERID="/%v/group_channels/%s/mute/%s".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_FREEZE="/%v/group_channels/%s/freeze".replace("%v",le.API_VERSION),le.API_STORAGE_FILE="/%v/storage/file".replace("%v",le.API_VERSION),le.API_STORAGE_PROFILE="/%v/storage/profile_image".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS="/%v/open_channels/%s/messages/changelogs".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS="/%v/group_channels/%s/messages/changelogs".replace("%v",le.API_VERSION),le.API_FRIENDS="/%v/users/%s/friends".replace("%v",le.API_VERSION),le.API_FRIENDS_CHANGE_LOGS="/%v/users/%s/friends/changelogs".replace("%v",le.API_VERSION),le.API_FRIENDS_DISCOVERIES="/%v/users/%s/friend_discoveries".replace("%v",le.API_VERSION),le.API_GROUPCHANNELS_OPERATORS="/%v/group_channels/%url/operators".replace("%v",le.API_VERSION),le.API_OPENCHANNELS_OPERATORS="/%v/open_channels/%url/operators".replace("%v",le.API_VERSION),le.UPDATE_META_COUNTER_MODE_SET=0,le.UPDATE_META_COUNTER_MODE_INC=1,le.UPDATE_META_COUNTER_MODE_DEC=2;var ce=function(){var e="";this.isLoading=!1,this.hasMore=!0,this.limit=20;var n=this;this.next=function(t){return _(n.limit)?n.hasMore?n.isLoading?void O(null,new I("Query in progress.",te.QUERY_IN_PROGRESS),t):(n.isLoading=!0,void le.getInstance().friendListQuery(e,n.limit,function(r,i){if(i)return n.isLoading=!1,void O(null,i,t);var a=r.users,s=a.map(function(e){return new W(e)});n.hasMore=r.has_more,n.isLoading=!1,e=r.next,O(s,null,t)})):void O([],null,t):void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),t)}},de=function(e,n,t,r){d?this[t]=e[n]:Object.defineProperty(e,t,{get:function(){return"_coverUrl"===n||"_coverImage"===n?e._channelCover:e[n]},set:function(t){if("file"===r){if("string"==typeof t||"object"!=typeof t)return}else if(r&&typeof t!==r)return;e[n]=t,"_coverUrl"!==n&&"_coverImage"!==n||(e._channelCover=t)}})},he=function(){this._isDistinct=null,de(this,"_isDistinct","isDistinct","boolean"),this._isSuper=null,de(this,"_isSuper","isSuper","boolean"),this._isPublic=null,de(this,"_isPublic","isPublic","boolean"),this._channelUrl=null,de(this,"_channelUrl","channelUrl","string"),this._name=null,de(this,"_name","name","string"),this._data=null,de(this,"_data","data","string"),this._customType=null,de(this,"_customType","customType","string"),this._channelCover=null,de(this,"_channelCover","channelCover",null),this._coverUrl=null,de(this,"_coverUrl","coverUrl","string"),this._coverImage=null,de(this,"_coverImage","coverImage","file"),this._operatorIds=[],this._operators=null,d?this.operators=this._operators:Object.defineProperty(this,"operators",{get:function(){return this._operators},set:function(e){if(Array.isArray(e)){for(var n=[],t=0;t<e.length;t++)e[t].hasOwnProperty("userId")?n.push(e[t].userId):n=[];n.length===e.length&&(this._operatorIds=n)}}}),this._operatorUserIds=null,d?this.operatorUserIds=this._operatorUserIds:Object.defineProperty(this,"operatorUserIds",{get:function(){return this._operatorUserIds},set:function(e){if(Array.isArray(e)){for(var n=[],t=0;t<e.length;t++)"string"==typeof e[t]?n.push(e[t]):n=[];n.length===e.length&&(this._operatorIds=n)}}}),this._isEphemeral=null,de(this,"_isEphemeral","isEphemeral","boolean"),this._inviteUserIds=[],this.addUsers=function(e){if(Array.isArray(e)){for(var n=e.length,t=[],r=0;r<n;r++)e[r].hasOwnProperty("userId")?t.push(e[r].userId):t=[];t.length>0&&(this._inviteUserIds=this._inviteUserIds.concat(t))}},this.addUser=function(e){e.hasOwnProperty("userId")&&this._inviteUserIds.push(e.userId)},this.addUserIds=function(e){if(Array.isArray(e)){for(var n=e.length,t=[],r=0;r<n;r++)"string"==typeof e[r]?t.push(e[r]):t=[];t.length>0&&(this._inviteUserIds=this._inviteUserIds.concat(t))}},this.addUserId=function(e){"string"==typeof e&&this._inviteUserIds.push(e)}},pe=function(){};pe.MentionType={USERS:"users",CHANNEL:"channel"};var _e=function(){this._message=null,de(this,"_message","message","string"),this._targetLanguages=null,d?this.targetLanguages=this._targetLanguages:Object.defineProperty(this,"targetLanguages",{get:function(){return this._targetLanguages},set:function(e){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("string"!=typeof e[n])return void(this._targetLanguages=[]);this._targetLanguages=e}}}),this._data=null,de(this,"_data","data","string"),this._customType=null,de(this,"_customType","customType","string"),this._mentionType=pe.MentionType.USERS,d?this.mentionType=this._mentionType:Object.defineProperty(this,"mentionType",{get:function(){return this._mentionType},set:function(e){[pe.MentionType.USERS,pe.MentionType.CHANNEL].indexOf(e)<0||(this._mentionType=e)}}),this._mentionedIds=[],this._mentionedUsers=null,d?this.mentionedUsers=this._mentionedUsers:Object.defineProperty(this,"mentionedUsers",{get:function(){return this._mentionedUsers},set:function(e){if(Array.isArray(e)){for(var n=[],t=[],r={},i=0;i<e.length;i++){if(!e[i].hasOwnProperty("userId"))return this._mentionedIds=[],
void(this._mentionedUsers=[]);r[e[i].userId]||(r[e[i].userId]=!0,Ee.getInstance().getCurrentUserId()!==e[i].userId&&(n.push(e[i]),t.push(e[i].userId)))}this._mentionedUserIds=[],this._mentionedIds=t,this._mentionedUsers=n}}}),this._mentionedUserIds=null,d?this.mentionedUserIds=this._mentionedUserIds:Object.defineProperty(this,"mentionedUserIds",{get:function(){return this._mentionedUserIds},set:function(e){if(Array.isArray(e)){for(var n=[],t={},r=0;r<e.length;r++){if("string"!=typeof e[r])return this._mentionedIds=[],void(this._mentionedUserIds=[]);t[e[r]]||(t[e[r]]=!0,Ee.getInstance().getCurrentUserId()!==e[r]&&n.push(e[r]))}this._mentionedUsers=[],this._mentionedIds=n,this._mentionedUserIds=n}}}),this._pushNotificationDeliveryOption=null,de(this,"_pushNotificationDeliveryOption","pushNotificationDeliveryOption","string")};_e.PushNotificationDeliveryOption={DEFAULT:"default",SUPPRESS:"suppress"};var fe=function(){this._file=null,d?this.file=this._file:Object.defineProperty(this,"file",{get:function(){return this._file},set:function(e){"string"!=typeof e&&"object"==typeof e&&(this._fileUrl=null,this._file=e)}}),this._fileUrl=null,d?this.fileUrl=this._fileUrl:Object.defineProperty(this,"fileUrl",{get:function(){return this._fileUrl},set:function(e){"string"==typeof e&&(this._file=null,this._fileUrl=e)}}),this._thumbnailSizes=null,d?this.thumbnailSizes=this._thumbnailSizes:Object.defineProperty(this,"thumbnailSizes",{get:function(){return this._thumbnailSizes},set:function(e){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"!=typeof e[n]||"number"!=typeof e[n].maxWidth||"number"!=typeof e[n].maxHeight)return void(this._thumbnailSizes=[]);this._thumbnailSizes=e}}}),this._fileName=null,de(this,"_fileName","fileName","string"),this._mimeType=null,de(this,"_mimeType","mimeType","string"),this._fileSize=null,de(this,"_fileSize","fileSize","number"),this._data=null,de(this,"_data","data","string"),this._customType=null,de(this,"_customType","customType","string"),this._mentionType=pe.MentionType.USERS,d?this.mentionType=this._mentionType:Object.defineProperty(this,"mentionType",{get:function(){return this._mentionType},set:function(e){[pe.MentionType.USERS,pe.MentionType.CHANNEL].indexOf(e)<0||(this._mentionType=e)}}),this._mentionedIds=[],this._mentionedUsers=null,d?this.mentionedUsers=this._mentionedUsers:Object.defineProperty(this,"mentionedUsers",{get:function(){return this._mentionedUsers},set:function(e){if(Array.isArray(e)){for(var n=[],t=[],r={},i=0;i<e.length;i++){if(!e[i].hasOwnProperty("userId"))return this._mentionedIds=[],void(this._mentionedUsers=[]);r[e[i].userId]||(r[e[i].userId]=!0,Ee.getInstance().getCurrentUserId()!==e[i].userId&&(n.push(e[i]),t.push(e[i].userId)))}this._mentionedUserIds=[],this._mentionedIds=t,this._mentionedUsers=n}}}),this._mentionedUserIds=null,d?this.mentionedUserIds=this._mentionedUserIds:Object.defineProperty(this,"mentionedUserIds",{get:function(){return this._mentionedUserIds},set:function(e){if(Array.isArray(e)){for(var n=[],t={},r=0;r<e.length;r++){if("string"!=typeof e[r])return this._mentionedIds=[],void(this._mentionedUserIds=[]);t[e[r]]||(t[e[r]]=!0,Ee.getInstance().getCurrentUserId()!==e[r]&&n.push(e[r]))}this._mentionedUsers=[],this._mentionedIds=n,this._mentionedUserIds=n}}}),this._pushNotificationDeliveryOption=null,de(this,"_pushNotificationDeliveryOption","pushNotificationDeliveryOption","string")};fe.PushNotificationDeliveryOption={DEFAULT:"default",SUPPRESS:"suppress"};var Ie=function(){this.networkHandlers={},this.authenticateTimer=1e4;var e=0,n=[],t=new I("Connection should be made first.",te.CONNECTION_REQUIRED),r=new I("Invalid parameter.",te.INVALID_PARAMETER);this.addReadyHandler=function(e){e&&"function"==typeof e&&n.push(e)},this.ready=function(e,n){var t=Ee.getInstance();return n?void e(t.currentUser,null):(this.addReadyHandler(e),t.isReconnectingOnError?void this.errorAllReadyHandler():void(t.getConnectionState()===t.ConnectionState.OPEN?this.processAllReadyHandler(null):t.getConnectionState()===t.ConnectionState.CONNECTING||this.errorAllReadyHandler()))},this.processAllReadyHandler=function(e){if(n.length>0){var t=n;n=[],t.forEach(function(n){n&&"function"==typeof n&&n(Ee.getInstance().currentUser,e)}),t=[]}},this.errorAllReadyHandler=function(){this.processAllReadyHandler(t)},this.NetworkHandler=function(){this.onReconnected=function(){}},this.addNetworkHandler=function(e,n){this.networkHandlers[e]=n},this.removeNetworkHandler=function(e){delete this.networkHandlers[e]},this.removeAllNetworkHandler=function(){this.networkHandlers={}},this.authenticate=function(n,i){var a=this,s=Ee.getInstance();if(s.getConnectionState()===s.ConnectionState.OPEN||s.reconnecting)s.connecting=!1,O(s.currentUser,null,i);else if(n&&"function"==typeof n){s.connecting=!0,e++;var o=setTimeout(function(){o=null,e--,0===e&&0===s.connectionCallback.length&&(s.connecting=!1),a.errorAllReadyHandler(),O(null,t,i)},a.authenticateTimer);n(function(n){if(o){clearTimeout(o),o=null,e--;var t=function(e,n){s.connecting=!1,n?O(null,new I(n.message,n.code),i):O(e,null,i)};n&&n.hasOwnProperty("userId")?n.apiHost&&n.wsHost?s.connect(n.userId,n.accessToken,n.apiHost,n.wsHost,t):s.connect(n.userId,n.accessToken,t):O(null,r,i)}})}else O(null,r,i)}},Ee=function(e){var o=Ee.getInstance();if(o)return o;try{if(!e.hasOwnProperty("appId"))return n.log("Must be set appId"),{}}catch(e){return n.log("Must be set appId"),{}}this.connecting=!1,this.reconnecting=!1,this.isReconnectingOnError=!1,this.ConnectionManager=new Ie,this.GCMPushToken="",this.APNSPushToken="",this.PUSH_TEMPLATE_DEFAULT="default",this.PUSH_TEMPLATE_ALTERNATIVE="alternative",this.isSessionOpened=!1,this.pushTokenRegistrationState={SUCCESS:"success",PENDING:"pending",ERROR:"error"},this.loginTimer,this.onLoginTimerCancel,this.globalTimer,this.reconnectTimer,this.onReconnectTimerCancel,this.currentUser=null,this.getCurrentUserId=function(){return Ee.getInstance().currentUser?Ee.getInstance().currentUser.userId:null},this.wsClient,this.connectionState={CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSING:"CLOSING",CLOSED:"CLOSED"},this.ConnectionState=this.connectionState,this.BaseChannel=E,this.User=W,this.Member=j,this.OpenChannel=G,this.GroupChannel=Y,this.UserMessage=w,this.FileMessage=F,this.AdminMessage=H,this.userEventHandlers={},this.channelHandlers={},this.connectionHandlers={},this.connectionCallback=[],this.GroupChannelParams=he,this.BaseMessageParams=pe,this.FileMessageParams=fe,this.UserMessageParams=_e,this.GroupChannelTotalUnreadMessageCountParams=V;var l={};L=e.appId,ge=this,ue=le.getInstance(),ue||(ue=new le),this.Options={_useMemberAsMessageSender:!1,get UseMemberAsMessageSender(){return this._useMemberAsMessageSender},set UseMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},get useMemberAsMessageSender(){return this._useMemberAsMessageSender},set useMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},_typingIndicatorThrottle:1e3,get typingIndicatorThrottle(){return this._typingIndicatorThrottle},set typingIndicatorThrottle(e){"number"==typeof e&&e>=a&&e<=s&&(this._typingIndicatorThrottle=e)}},this.customApiHost=null,this.customWsHost=null,this.UserEventHandler=function(){this.onFriendsDiscovered=function(e){}},this.addUserEventHandler=function(e,n){Ee.getInstance().userEventHandlers[e]=n},this.removeUserEventHandler=function(e){delete Ee.getInstance().userEventHandlers[e]},this.removeAllUserEventHandler=function(){Ee.getInstance().userEventHandlers={}},this.ChannelHandler=function(){this.onMessageReceived=function(e,n){},this.onMessageUpdated=function(e,n){},this.onMessageDeleted=function(e,n){},this.onReadReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,n){},this.onUserLeft=function(e,n){},this.onUserEntered=function(e,n){},this.onUserExited=function(e,n){},this.onUserMuted=function(e,n){},this.onUserUnmuted=function(e,n){},this.onUserBanned=function(e,n){},this.onUserUnbanned=function(e,n){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e){},this.onUserReceivedInvitation=function(e,n,t){},this.onUserDeclinedInvitation=function(e,n,t){},this.onMetaDataCreated=function(e,n){},this.onMetaDataUpdated=function(e,n){},this.onMetaDataDeleted=function(e,n){},this.onMetaCountersCreated=function(e,n){},this.onMetaCountersUpdated=function(e,n){},this.onMetaCountersDeleted=function(e,n){},this.onChannelHidden=function(e){},this.onMentionReceived=function(e,n){}},this.addChannelHandler=function(e,n){Ee.getInstance().channelHandlers[e]=n},this.removeChannelHandler=function(e){delete Ee.getInstance().channelHandlers[e]},this.removeAllChannelHandlers=function(){Ee.getInstance().channelHandlers={}},this.ConnectionHandler=function(){this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}},this.addConnectionHandler=function(e,n){Ee.getInstance().connectionHandlers[e]=n},this.removeConnectionHandler=function(e){delete Ee.getInstance().connectionHandlers[e]},this.removeAllConnectionHandlers=function(){Ee.getInstance().connectionHandlers={}},this.createUserListQuery=function(e){return e?new ne(ne.FILTERED_USER,e):new ne(ne.ALL_USER)},this.createBlockedUserListQuery=function(){return new ne(ne.BLOCKED_USER)},this.getApplicationId=function(){return L},this.getDebugMode=function(){return t},this.setDebugMode=function(e){t=e},this.setAPIHost=function(e){i=e},this.setWSHost=function(e){r=e},this.clearCurrentApiHost=function(){this.customApiHost=null},this.getCurrentApiHost=function(){return this.customApiHost?this.customApiHost:i},this.clearCurrentWsHost=function(){this.customWsHost=null},this.getCurrentWsHost=function(){return this.customWsHost?this.customWsHost:r},this.setErrorFirstCallback=function(e){P=e},this.getErrorFirstCallback=function(){return P},this.getConnectionState=function(){try{if(Ee.getInstance()){var e=Ee.getInstance();return e.connecting||e.reconnecting?e.connectionState.CONNECTING:e.wsClient?e.connecting||e.reconnecting?e.connectionState.CONNECTING:e.isSessionOpened?e.wsClient.getConnectionState():e.connectionState.CLOSED:e.connectionState.CLOSED}return Ee.getInstance().connectionState.CLOSED}catch(e){return Ee.getInstance().connectionState.CLOSED}},this.hasLoggedIn=function(){return Ee.getInstance().currentUser&&le.getInstance().sessionKey};var u=function(e){return l.hasOwnProperty(e)?l[e]:null},c=function(e){var t=new q(e);if(t.requestId){var r=u(t.requestId);if(null==r)return;clearTimeout(r.timer);var i=r.handler;if(i)if("EROR"===t.command){var a=t.getJsonElement(),s=a.code,o=a.message;i(t,new I(o,s))}else i(t,null);try{delete l[t.requestId]}catch(e){}}else switch(se&&"LOGI"!==t.command&&se.start(),t.command){case"LOGI":if(Ee.getInstance().loginTimer){clearTimeout(Ee.getInstance().loginTimer),Ee.getInstance().loginTimer=null,Ee.getInstance().onLoginTimerCancel=null;var c=t.getJsonElement();if(c.hasOwnProperty("error")){Ee.getInstance().isSessionOpened=!1;var s=c.code,o=c.message;Ee.getInstance().loginHandler(null,new I(o,s))}else Ee.getInstance().isSessionOpened=!0,c.hasOwnProperty("key")&&(le.getInstance().sessionKey=c.key),c.hasOwnProperty("ekey")&&(le.getInstance().ekey=c.ekey),c.hasOwnProperty("user_id")&&(Ee.getInstance().currentUser=new W(c)),c.hasOwnProperty("ping_interval")&&"number"==typeof c.ping_interval&&c.ping_interval>0&&(re=1e3*c.ping_interval),c.hasOwnProperty("pong_timeout")&&"number"==typeof c.pong_timeout&&c.pong_timeout>0&&(ie=1e3*c.pong_timeout),se&&se.start(),Ee.getInstance().loginHandler(Ee.getInstance().currentUser,null);Ee.getInstance().connecting=!1,Ee.getInstance().reconnecting=!1}break;case"MESG":case"FILE":case"BRDM":case"ADMM":var p="",_=!1;if("MESG"===t.command?p=new w(t.getJsonElement()):"FILE"===t.command?p=new F(t.getJsonElement()):(p=new H(t.getJsonElement()),t.getJsonElement().hasOwnProperty("silent")&&(_=t.getJsonElement().silent)),!p)return;if(p.isGroupChannel()){var f=Y.cachedChannels.hasOwnProperty(p.channelUrl);Y.getChannel(p.channelUrl,function(e,n){if(P){var t=e;e=n,n=t}if(n)return void(i&&i(null,n));if(e.isHidden=!1,Y.cachedChannels[e.url]=e,p._sender&&e.memberMap.hasOwnProperty(p._sender.userId)){var r=e.memberMap[p._sender.userId];r.nickname!==p._sender.nickname&&(r.nickname=p._sender.nickname),r.profileUrl!==p._sender.profileUrl&&(r.profileUrl=p._sender.profileUrl)}var a=Ee.getInstance().currentUser;a&&p._sender&&a.userId===p._sender.userId&&(a.nickname!==p._sender.nickname&&(a.nickname=p._sender.nickname),a.profileUrl!==p._sender.profileUrl&&(a.profileUrl=p._sender.profileUrl));var s=!1;if(p.mentionType===pe.MentionType.CHANNEL)p.sender&&p.sender.userId===Ee.getInstance().getCurrentUserId()||(s=!0);else if(p.mentionType===pe.MentionType.USERS)for(var o in p.mentionedUsers)if((!p.sender||p.sender.userId!==Ee.getInstance().getCurrentUserId())&&p.mentionedUsers[o].userId===Ee.getInstance().getCurrentUserId()){s=!0;break}if(_||(e.isEphemeral?((!e.lastMessage||e.lastMessage.createdAt<p.createdAt)&&(e.lastMessage=p),p.sender&&p.sender.userId===Ee.getInstance().getCurrentUserId()||A(e,e.unreadMessageCount+1,e.unreadMentionCount+(s?1:0))):f&&((!e.lastMessage||e.lastMessage.createdAt<p.createdAt)&&(e.lastMessage=p),p.sender&&p.sender.userId===Ee.getInstance().getCurrentUserId()||A(e,e.unreadMessageCount+1,e.unreadMentionCount+(s?1:0)))),!_)for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onChannelChanged(e)}for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onMessageReceived(e,p),s&&l.onMentionReceived(e,p)}})}else G.getChannel(p.channelUrl,function(e,n){if(P){var t=e;e=n,n=t}if(n)return void(i&&i(null,n));var r=!1;if(p.mentionType===pe.MentionType.CHANNEL)r=!0;else if(p.mentionType===pe.MentionType.USERS)for(var a in p.mentionedUsers)if(p.mentionedUsers[a].userId===Ee.getInstance().getCurrentUserId()){r=!0;break}for(var a in Ee.getInstance().channelHandlers){var s=Ee.getInstance().channelHandlers[a];G.enteredChannels[e.url]&&s.onMessageReceived(e,p),r&&s.onMentionReceived(e,p)}});break;case"MEDI":case"FEDI":case"AEDI":var _=!1,p="";if("MEDI"===t.command?p=new w(t.getJsonElement()):"FEDI"===t.command?p=new F(t.getJsonElement()):(p=new H(t.getJsonElement()),t.getJsonElement().hasOwnProperty("silent")&&(_=t.getJsonElement().silent)),!p)return;if(p.isGroupChannel()){var f=Y.cachedChannels.hasOwnProperty(p.channelUrl);Y.getChannel(p.channelUrl,function(e,n){if(P){var r=e;e=n,n=r}if(n)return void(i&&i(null,n));var a=e.cachedReadReceiptStatus[Ee.getInstance().getCurrentUserId()],s=a&&a>=p.createAt;if(p._sender&&e.memberMap.hasOwnProperty(p._sender.userId)){var o=e.memberMap[p._sender.userId];o.nickname!==p._sender.nickname&&(o.nickname=p._sender.nickname),o.profileUrl!==p._sender.profileUrl&&(o.profileUrl=p._sender.profileUrl)}var l=Ee.getInstance().currentUser;l&&p._sender&&l.userId===p._sender.userId&&(l.nickname!==p._sender.nickname&&(l.nickname=p._sender.nickname),l.profileUrl!==p._sender.profileUrl&&(l.profileUrl=p._sender.profileUrl));var u=!1,c=t.getJsonElement();if((!p.sender||p.sender.userId!==Ee.getInstance().getCurrentUserId())&&!s&&c&&c.hasOwnProperty("old_values")){var d=c.old_values.mention_type||p.mentionType,h=c.old_values.mentioned_user_ids||p.mentionedUsers.map(function(e){return e.userId});if(d===pe.MentionType.USERS&&p.mentionType===pe.MentionType.USERS){var I=!1,E=!1;for(var g in h)if(h[g]===Ee.getInstance().getCurrentUserId()){I=!0;break}for(var g in p.mentionedUsers)if(p.mentionedUsers[g].userId===Ee.getInstance().getCurrentUserId()){E=!0;break}!I&&E&&(u=!0,f&&A(e,e.unreadMessageCount,e.unreadMentionCount+1))}else if(d===pe.MentionType.USERS&&p.mentionType===pe.MentionType.CHANNEL){var m=!1;for(var g in h)if(h[g]===Ee.getInstance().getCurrentUserId()){m=!0;break}m||(u=!0,f&&A(e,e.unreadMessageCount,e.unreadMentionCount+1))}}var v=!1;if(e.lastMessage&&e.lastMessage.messageId===p.messageId&&(f?e.lastMessage.updatedAt<p.updatedAt&&(e.lastMessage=p,v=!0):v=!0),!_&&(v||u))for(var g in Ee.getInstance().channelHandlers){var C=Ee.getInstance().channelHandlers[g];C.onChannelChanged(e)}for(var g in Ee.getInstance().channelHandlers){var C=Ee.getInstance().channelHandlers[g];C.onMessageUpdated(e,p),u&&C.onMentionReceived(e,p)}})}else G.getChannel(p.channelUrl,function(e,n){if(P){var t=e;e=n,n=t}if(n)return void(i&&i(null,n));for(var r in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[r].onMessageUpdated(e,p)}});break;case"READ":var E=new K(t.getJsonElement()),f=Y.cachedChannels.hasOwnProperty(E.channelUrl);Y.getChannel(E.channelUrl,function(e,n){if(P){var t=e;e=n,n=t}if(n)return void(i&&i(null,n));if(f&&e.updateReadReceipt(E.reader.userId,E.timestamp),E.reader.userId===Ee.getInstance().getCurrentUserId()){if(f){if((e.unreadMessageCount>0||e.unreadMentionCount>0)&&(A(e,0,0),0===e.unreadMessageCount||0===e.unreadMentionCount))for(var r in Ee.getInstance().channelHandlers){var a=Ee.getInstance().channelHandlers[r];a.onChannelChanged(e)}}else if(0===e.unreadMessageCount||0===e.unreadMentionCount)for(var r in Ee.getInstance().channelHandlers){var a=Ee.getInstance().channelHandlers[r];a.onChannelChanged(e)}}else for(var r in Ee.getInstance().channelHandlers){var a=Ee.getInstance().channelHandlers[r];a.onReadReceiptUpdated(e)}});break;case"TPST":case"TPEN":case"MTIO":break;case"SYEV":h(t);break;case"USEV":d(t);break;case"DELM":var g=t.getJsonElement(),m=String(g.channel_type),v=String(g.channel_url),C=String(g.msg_id);switch(m){case k.CHANNEL_TYPE_OPEN:G.getChannel(v,function(e,t){if(P){var r=e;e=t,t=r}if(t)return void n.log("Discard a command.");for(var i in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[i].onMessageDeleted(e,C)}});break;case k.CHANNEL_TYPE_GROUP:Y.getChannel(v,function(e,t){if(P){var r=e;e=t,t=r}if(t)return void n.log("Discard a command.");for(var i in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[i].onMessageDeleted(e,C)}})}}},d=function(e){var n=new B(e.getJsonElement());switch(n.category){case x.CATEGORY_USER_BLOCK:case x.CATEGORY_USER_UNBLOCK:var t=n.data.blocker.user_id,r=n.data.blockee.user_id;Object.keys(Y.cachedChannels).forEach(function(e){var i=Y.cachedChannels[e];try{Ee.getInstance().getCurrentUserId()===t?i.memberMap[r].isBlockedByMe=n.category===x.CATEGORY_USER_BLOCK:Ee.getInstance().getCurrentUserId()===r&&(i.memberMap[t].isBlockingMe=n.category===x.CATEGORY_USER_BLOCK)}catch(e){}});break;case x.CATEGORY_FRIEND_DISCOVERED:var i=n.data.friend_discoveries,a=i.map(function(e){return new W(e)});for(var s in Ee.getInstance().userEventHandlers){Ee.getInstance().userEventHandlers[s].onFriendsDiscovered(a)}}},h=function(e){var t=e.getJsonElement(),r=new B(t);switch(r.category){case B.CATEGORY_CHANNEL_JOIN:case B.CATEGORY_CHANNEL_LEAVE:Y.getChannel(r.channelUrl,function(i,a){if(P){var s=i;i=a,a=s}if(a)return void n.log("Discard a command: "+e.command+":"+r.category);var o=r.data.hasOwnProperty("member_count")?r.data.member_count:null,l=r.data.hasOwnProperty("joined_member_count")?r.data.joined_member_count:null;if(r.category===B.CATEGORY_CHANNEL_JOIN){(r.data.hasOwnProperty("users")?r.data.users:function(e){return e.state=j.JOINED,[e]}(r.data)).forEach(function(e){!function(e,n,r){i.isSuper?i.setLatestMemberCount(n,r,t.ts):(e.state=j.JOINED,i.addMember(new j(e)),i.updateJoinedMemberCount());var a=new W(e);a.userId===Ee.getInstance().getCurrentUserId()&&(i.myMemberState="joined",Y.cachedChannels[i.url]=i);for(var s in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[s].onUserJoined(i,a)}}(e,o,l)})}else{var u=new W(r.data);u.userId===Ee.getInstance().getCurrentUserId()?(i.isPublic||Y.removeCachedChannel(r.channelUrl),i.myMemberState="none",i.invitedAt=0,A(i,0,0)):Y.cachedChannels[i.url]=i,i.isSuper?i.setLatestMemberCount(o,l,t.ts):(i.removeMember(u),i.updateJoinedMemberCount());for(var c in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[c].onUserLeft(i,u)}}});break;case B.CATEGORY_CHANNEL_INVITE:Y.getChannel(r.channelUrl,function(i,a){if(P){var s=i;i=a,a=s}if(a)return void n.log("Discard a command: "+e.command+":"+r.category);var o=null;r.data&&r.data.inviter&&!p(r.data.inviter)&&(o=new W(r.data.inviter));var l=[];for(var u in r.data.invitees){var c=new W(r.data.invitees[u]);l.push(c),r.data.invitees[u].state=j.INVITED;var d=new j(r.data.invitees[u]);if(i.isSuper){var h=r.data.hasOwnProperty("member_count")?r.data.member_count:null,_=r.data.hasOwnProperty("joined_member_count")?r.data.joined_member_count:null;i.setLatestMemberCount(h,_,t.ts)}else i.addMember(d);d.userId===Ee.getInstance().getCurrentUserId()&&(i.isHidden=!1,"joined"!==i.myMemberState&&(i.myMemberState="invited"),i.invitedAt=t.ts,Y.cachedChannels[i.url]=i)}for(var u in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[u].onUserReceivedInvitation(i,o,l)}});break;case B.CATEGORY_CHANNEL_DECLINE_INVITE:Y.getChannel(r.channelUrl,function(i,a){if(P){var s=i;i=a,a=s}if(a)return void n.log("Discard a command: "+e.command+":"+r.category);var o=null;r.data&&r.data.inviter&&!p(r.data.inviter)&&(o=new W(r.data.inviter));var l=new W(r.data.invitee);if(l.userId===Ee.getInstance().getCurrentUserId()&&(i.invitedAt=0,i.myMemberState="none",i.isPublic||Y.removeCachedChannel(r.channelUrl)),i.isSuper){var u=r.data.hasOwnProperty("member_count")?r.data.member_count:null,c=r.data.hasOwnProperty("joined_member_count")?r.data.joined_member_count:null;i.setLatestMemberCount(u,c,t.ts)}else i.removeMember(l);l.userId!==Ee.getInstance().getCurrentUserId()&&(Y.cachedChannels[i.url]=i);for(var d in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[d].onUserDeclinedInvitation(i,o,l)}});break;case B.CATEGORY_TYPING_START:case B.CATEGORY_TYPING_END:Y.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);var s=new W(r.data);r.category===B.CATEGORY_TYPING_START?t.updateTypingStatus(s,!0):t.updateTypingStatus(s,!1);for(var o in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[o].onTypingStatusUpdated(t)}});break;case B.CATEGORY_CHANNEL_ENTER:case B.CATEGORY_CHANNEL_EXIT:G.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);r.data.hasOwnProperty("participant_count")&&(t.participantCount=r.data.participant_count);var s=new W(r.data);if(r.category===B.CATEGORY_CHANNEL_ENTER)for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserEntered(t,s)}else for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserExited(t,s)}});break;case B.CATEGORY_USER_CHANNEL_MUTE:case B.CATEGORY_USER_CHANNEL_UNMUTE:r.isOpenChannel()?G.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);var s=new W(r.data);if(r.category===B.CATEGORY_USER_CHANNEL_MUTE)for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserMuted(t,s)}else for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserUnmuted(t,s)}}):Y.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);var s=new W(r.data);if(s.userId===Ee.getInstance().getCurrentUserId()&&(t.myMutedState=r.category===B.CATEGORY_USER_CHANNEL_MUTE?"muted":"unmuted"),r.category===B.CATEGORY_USER_CHANNEL_MUTE)for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserMuted(t,s)}else for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserUnmuted(t,s)}});break;case B.CATEGORY_USER_CHANNEL_BAN:case B.CATEGORY_USER_CHANNEL_UNBAN:r.isOpenChannel()?G.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);var s=new W(r.data);if(r.category===B.CATEGORY_USER_CHANNEL_BAN){s.userId===Ee.getInstance().getCurrentUserId()&&delete G.enteredChannels[r.channelUrl];for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserBanned(t,s)}}else for(var o in Ee.getInstance().channelHandlers){var l=Ee.getInstance().channelHandlers[o];l.onUserUnbanned(t,s)}}):Y.getChannel(r.channelUrl,function(i,a){if(P){var s=i;i=a,a=s}if(a)return void n.log("Discard a command: "+e.command+":"+r.category);var o=new W(r.data);if(r.category===B.CATEGORY_USER_CHANNEL_BAN){if(o.userId===Ee.getInstance().getCurrentUserId()&&(i.isPublic||Y.removeCachedChannel(r.channelUrl),i.myMemberState="none",i.invitedAt=0,A(i,0,0)),i.isSuper){var l=r.data.hasOwnProperty("member_count")?r.data.member_count:null,u=r.data.hasOwnProperty("joined_member_count")?r.data.joined_member_count:null;i.setLatestMemberCount(l,u,t.ts)}else i.removeMember(o),i.updateJoinedMemberCount();for(var c in Ee.getInstance().channelHandlers){var d=Ee.getInstance().channelHandlers[c];d.onUserBanned(i,o)}}else for(var c in Ee.getInstance().channelHandlers){var d=Ee.getInstance().channelHandlers[c];d.onUserUnbanned(i,o)}});break;case B.CATEGORY_CHANNEL_FREEZE:case B.CATEGORY_CHANNEL_UNFREEZE:r.isOpenChannel()?G.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);if(t.isFrozen=r.data.freeze,G.cachedChannels[t.url]=t,r.category===B.CATEGORY_CHANNEL_FREEZE)for(var s in Ee.getInstance().channelHandlers){var o=Ee.getInstance().channelHandlers[s];o.onChannelFrozen(t)}else for(var s in Ee.getInstance().channelHandlers){var o=Ee.getInstance().channelHandlers[s];o.onChannelUnfrozen(t)}}):Y.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);if(t.isFrozen=r.data.freeze,Y.cachedChannels[t.url]=t,r.category===B.CATEGORY_CHANNEL_FREEZE)for(var s in Ee.getInstance().channelHandlers){var o=Ee.getInstance().channelHandlers[s];o.onChannelFrozen(t)}else for(var s in Ee.getInstance().channelHandlers){var o=Ee.getInstance().channelHandlers[s];o.onChannelUnfrozen(t)}});break;case B.CATEGORY_CHANNEL_DELETED:if(r.isGroupChannel()){Y.removeCachedChannel(r.channelUrl);for(var i in Ee.getInstance().channelHandlers){var a=Ee.getInstance().channelHandlers[i];a.onChannelDeleted(r.channelUrl,"group")}}else{G.removeCachedChannel(r.channelUrl),delete G.enteredChannels[r.channelUrl];for(var i in Ee.getInstance().channelHandlers){var a=Ee.getInstance().channelHandlers[i];a.onChannelDeleted(r.channelUrl,"open")}}break;case B.CATEGORY_CHANNEL_PROP_CHANGED:r.isOpenChannel()?G.getChannelWithoutCache(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);for(var s in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[s].onChannelChanged(t)}}):Y.getChannelWithoutCache(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);var s=t.unreadMessageCount,o=t.unreadMentionCount;t.myCountPreference!==Y.CountPreference.ALL&&(t.myCountPreference===Y.CountPreference.UNREAD_MESSAGE_COUNT_ONLY?o=0:t.myCountPreference===Y.CountPreference.UNREAD_MENTION_COUNT_ONLY?s=0:(s=0,o=0)),A(t,s,o);for(var l in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[l].onChannelChanged(t)}});break;case B.CATEGORY_CHANNEL_META_DATA_CHANGED:case B.CATEGORY_CHANNEL_META_COUNTERS_CHANGED:var s=r.data.hasOwnProperty("created"),o=r.data.hasOwnProperty("updated"),l=r.data.hasOwnProperty("deleted");r.isOpenChannel()?G.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);for(var u in Ee.getInstance().channelHandlers){var c=Ee.getInstance().channelHandlers[u];r.category===B.CATEGORY_CHANNEL_META_DATA_CHANGED?(s&&c.onMetaDataCreated(t,r.data.created),o&&c.onMetaDataUpdated(t,r.data.updated),l&&c.onMetaDataDeleted(t,r.data.deleted)):(s&&c.onMetaCountersCreated(t,r.data.created),o&&c.onMetaCountersUpdated(t,r.data.updated),l&&c.onMetaCountersDeleted(t,r.data.deleted))}}):Y.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);for(var u in Ee.getInstance().channelHandlers){var c=Ee.getInstance().channelHandlers[u];r.category===B.CATEGORY_CHANNEL_META_DATA_CHANGED?(s&&c.onMetaDataCreated(t,r.data.created),o&&c.onMetaDataUpdated(t,r.data.updated),l&&c.onMetaDataDeleted(t,r.data.deleted)):(s&&c.onMetaCountersCreated(t,r.data.created),o&&c.onMetaCountersUpdated(t,r.data.updated),l&&c.onMetaCountersDeleted(t,r.data.deleted))}});break;case B.CATEGORY_CHANNEL_HIDE:Y.getChannel(r.channelUrl,function(t,i){if(P){var a=t;t=i,i=a}if(i)return void n.log("Discard a command: "+e.command+":"+r.category);if(t.isHidden=!0,r.data&&r.data.hasOwnProperty("hide_previous_messages")&&r.data.hide_previous_messages&&Y.cachedChannels){var s=Y.cachedChannels[t.url];A(s,0,0),Y.cachedChannels[t.url]=s}for(var o in Ee.getInstance().channelHandlers){Ee.getInstance().channelHandlers[o].onChannelHidden(t)}})}};this.setPushTemplate=function(e,n){if(!e||e!==this.PUSH_TEMPLATE_DEFAULT&&e!==this.PUSH_TEMPLATE_ALTERNATIVE)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().setPushTemplate(e,function(e,t){if(t)return void O(null,t,n);var r=e.name.toString();O(r,null,n)})},this.getPushTemplate=function(e){le.getInstance().getPushTemplate(function(n,t){if(t)return void O(null,t,e);var r=n.name.toString();O(r,null,e)})},this.setChannelInvitationPreference=function(e,n){"boolean"!=typeof e&&O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n),le.getInstance().setChannelInvitationPreference(e,function(e,t){if(t)return void O(null,t,n);O({autoAccept:e.auto_accept},null,n)})},this.getChannelInvitationPreference=function(e){le.getInstance().getChannelInvitationPreference(function(n,t){if(t)return void O(null,t,e);O({autoAccept:n.auto_accept},null,e)})},this.connect=function(){v&&v.start();var e=Array.prototype.slice.call(arguments),r=null,i=null,a=null;switch("function"==typeof e.slice(-1)[0]&&(a=e.pop()),e.length){case 1:r=e[0];break;case 2:r=e[0],i=e[1];break;case 3:r=e[0],this.customApiHost=e[1],this.customWsHost=e[2];break;case 4:r=e[0],i=e[1],this.customApiHost=e[2],this.customWsHost=e[3];break;default:t&&n.log("sb.connect args length error: ",arguments)}r&&0!==r.length?(Ee.getInstance().connecting=!0,Ee.getInstance().reconnecting=!1,Ee.getInstance().isReconnectingOnError=!1,Ee.getInstance().reconnectTimer&&(clearTimeout(Ee.getInstance().reconnectTimer),Ee.getInstance().reconnectTimer=null,Ee.getInstance().onReconnectTimerCancel=null),Ee.getInstance().getConnectionState()===this.connectionState.OPEN&&Ee.getInstance().getCurrentUserId()===r?(Ee.getInstance().connecting=!1,O(Ee.getInstance().currentUser,null,a)):(Ee.getInstance().connectionCallback.push(a),1===Ee.getInstance().connectionCallback.length&&(m(!0,null),N(r,i)))):O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),a)};var _=!1,f=!1,g=!0;this.setBackgroundState=function(){!_&&g&&(_=!0,this.getConnectionState()!==this.connectionState.CLOSED?(f=!0,m(!1,null)):f=!1)},this.setForegroundState=function(){_&&g&&(_=!1,f&&this.currentUser&&(M=0,C(this.getCurrentUserId(),!0)))},this.disableStateChange=function(){g=!1},this.enableStateChange=function(){g=!0},this.disconnect=function(e){v&&v.stop(),m(!0,e)},this.reconnect=function(){if(!le.getInstance().sessionKey||!this.currentUser)return!1;var e=!0;return M>0&&(e=!1),m(!1,null),M=0,C(this.getCurrentUserId(),e),!0};var m=function(e,n){var t=this;Ee.getInstance().loginTimer&&(clearTimeout(Ee.getInstance().loginTimer),
Ee.getInstance().onLoginTimerCancel&&(Ee.getInstance().onLoginTimerCancel(),Ee.getInstance().onLoginTimerCancel=null),Ee.getInstance().loginTimer=null),Ee.getInstance().reconnectTimer&&(clearTimeout(Ee.getInstance().reconnectTimer),Ee.getInstance().onReconnectTimerCancel&&(Ee.getInstance().onReconnectTimerCancel(),Ee.getInstance().onReconnectTimerCancel=null),Ee.getInstance().reconnectTimer=null),Ee.getInstance().wsClient&&(M=0,Ee.getInstance().wsClient.disconnect(!0),Ee.getInstance().wsClient=null),function(){if(e){G.clearEnteredChannels(),G.clearCache(),Y.clearCache(),Ee.getInstance().globalTimer&&(clearTimeout(t.globalTimer),Ee.getInstance().globalTimer=null);for(var r in Ee.getInstance().ackStateMap)clearTimeout(Ee.getInstance().ackStateMap[r].timer);Ee.getInstance().ackStateMap={},Ee.getInstance().currentUser=null,le.getInstance().sessionKey=null,le.getInstance().ekey=null}O(null,null,n)}()},C=function(e,r){if(Ee.getInstance().reconnecting=!0,Ee.getInstance().reconnectTimer)t&&n.log("still reconnecting");else{if((M+=1)<=1){if(r)for(var i in Ee.getInstance().connectionHandlers){var a=Ee.getInstance().connectionHandlers[i];a.onReconnectStarted(i)}D=0}else D=3e3*Math.pow(2,M-2);if(!e||!le.getInstance().sessionKey||M>=6){m(!1,null),M=0;for(var i in Ee.getInstance().connectionHandlers){var a=Ee.getInstance().connectionHandlers[i];a.onReconnectFailed(i)}return Ee.getInstance().connecting=!1,Ee.getInstance().reconnecting=!1,Ee.getInstance().isReconnectingOnError=!1,void Ee.getInstance().ConnectionManager.errorAllReadyHandler()}Ee.getInstance().onReconnectTimerCancel=function(){M=0},Ee.getInstance().reconnectTimer=setTimeout(function(){Ee.getInstance().reconnectTimer=null,Ee.getInstance().onReconnectTimerCancel=null,Ee.getInstance().wsClient&&Ee.getInstance().wsClient.disconnect(!0);var r=new oe.WSClientHandler;Ee.getInstance().wsClient=new oe(r),Ee.getInstance().loginHandler=function(e){M=0,Ee.getInstance().connecting=!1,Ee.getInstance().reconnecting=!1,Ee.getInstance().isReconnectingOnError=!1;for(var n in Ee.getInstance().connectionHandlers){Ee.getInstance().connectionHandlers[n].onReconnectSucceeded(n)}if(Ee.getInstance().ConnectionManager.processAllReadyHandler(null),Ee.getInstance().isReconnectingOnError)for(var t in Ee.getInstance().ConnectionManager.networkHandlers)Ee.getInstance().ConnectionManager.networkHandlers[t].onReconnected();var r=[];for(var t in G.enteredChannels)r.push(t);for(var n=0;n<r.length;n++){var i=r[n],a=G.enteredChannels[i];!function(e){e.enter(function(e,n){n&&delete G.enteredChannels[i]})}(a)}},r.onOpen=function(){t&&n.log("reconnectWS onOpen"),Ee.getInstance().loginTimer=setTimeout(function(){t&&n.log("reconnectWS loginTimer timedout"),Ee.getInstance().loginTimer=null,C(e,!0)},1e4),Ee.getInstance().onLoginTimerCancel=null,Ee.getInstance().reconnecting=!1},r.onMessage=function(e){c(e)},r.onError=function(){t&&n.log("reconnectWS onError"),Ee.getInstance().isReconnectingOnError=!0,Ee.getInstance().ConnectionManager.errorAllReadyHandler(),C(e,!0)},r.onClose=function(){t&&n.log("reconnectWS onClose"),Ee.getInstance().reconnecting=!1};var i=Ee.getInstance().getCurrentApiHost();le.getInstance().checkRouting(function(n,t){if(t)return void C(e,!0);i!==n.API_HOST&&T(n.API_HOST,{},"GET",{},function(){}),Ee.getInstance().wsClient.connect(e,null,n.WS_HOST)})},D)}},N=function(e,r){var i=new oe.WSClientHandler;Ee.getInstance().wsClient=new oe(i),i.onMessage=function(e){c(e)},Ee.getInstance().loginHandler=function(e,n){if(Ee.getInstance().connecting=!1,n)Ee.getInstance().disconnect(null),Ee.getInstance().connectionCallback.forEach(function(e){O(null,n,e)}),Ee.getInstance().connectionCallback=[];else{clearTimeout(Ee.getInstance().globalTimer);var t=function(){if(Y.cachedChannels)for(var e in Y.cachedChannels){var n=Y.cachedChannels[e];if(n.invalidateTypingStatus())for(var r in Ee.getInstance().channelHandlers){var i=Ee.getInstance().channelHandlers[r];i.onTypingStatusUpdated(n)}}Ee.getInstance().globalTimer=setTimeout(function(){t()},1e3)};t();var r=Ee.getInstance().connectionCallback;Ee.getInstance().connectionCallback=[],r.forEach(function(n){O(e,null,n)}),r=[],Ee.getInstance().connecting=!1,Ee.getInstance().reconnecting=!1,Ee.getInstance().ConnectionManager.processAllReadyHandler(null)}},i.onOpen=function(e){Ee.getInstance().loginTimer=setTimeout(function(){Ee.getInstance().loginTimer=null,Ee.getInstance().onLoginTimerCancel=null,Ee.getInstance().disconnect(null),Ee.getInstance().connectionCallback.forEach(function(e){O(null,new I("Connection timeout.",te.LOGIN_TIMEOUT),e)}),Ee.getInstance().connectionCallback=[]},1e4),Ee.getInstance().onLoginTimerCancel=function(){Ee.getInstance().connectionCallback.forEach(function(e){O(null,new I("Connection Cancelled.",te.REQUEST_FAILED),e)}),Ee.getInstance().connectionCallback=[]},Ee.getInstance().connecting=!1},i.onError=function(r){t&&n.log("WSClientHandler.onError",r),le.getInstance().sessionKey?(Ee.getInstance().isReconnectingOnError=!0,Ee.getInstance().ConnectionManager.errorAllReadyHandler(),C(e,!0)):(Ee.getInstance().connectionCallback.forEach(function(e){O(null,new I("Websocket connection failed.",te.WEBSOCKET_CONNECTION_FAILED),e)}),Ee.getInstance().connectionCallback=[]),Ee.getInstance().connecting=!1},i.onClose=function(e){t&&n.log("WSClientHandler.onClose"),Ee.getInstance().connecting=!1},le.getInstance().checkRouting(function(n,t){if(t)return Ee.getInstance().connectionCallback.forEach(function(e){O(null,new I("Connection routing failed.",te.REQUEST_FAILED),e)}),Ee.getInstance().connectionCallback=[],void(Ee.getInstance().connecting=!1);T(n.API_HOST,{},"GET",{},function(){}),Ee.getInstance().wsClient.connect(e,r,n.WS_HOST)})};this.sendCommand=function(e,n){Ee.getInstance().ConnectionManager.ready(function(t,r){if(r)return void(n&&n(null,r));if(null==Ee.getInstance().wsClient||Ee.getInstance().wsClient.getConnectionState()!==Ee.getInstance().connectionState.OPEN||Ee.getInstance().getConnectionState()!==Ee.getInstance().ConnectionState.OPEN)return void(n&&n(null,new I("Connection is not valid. Please reconnect.",te.WEBSOCKET_CONNECTION_CLOSED)));if(e.isAckRequired()){var i=e.requestId,a={handler:n,timer:setTimeout(function(){n(null,new I("Command received no ack.",te.ACK_TIMEOUT)),delete l[i]},1e4)};l[i]=a,Ee.getInstance().wsClient.send(e,function(e,t){if(t)return clearTimeout(a.timer),void n(null,t)})}else Ee.getInstance().wsClient.send(e,n)})},this.markAsReadAll=function(e){var n=(new Date).getTime();if(n-Y.markAsReadAllLastSentAt<1e3)return void O(null,new I("MarkAsRead rate limit exceeded.",te.MARK_AS_READ_RATE_LIMIT_EXCEEDED),e);Y.markAsReadAllLastSentAt=n,le.getInstance().groupChannelMarkAsReadAll(null,function(t,r){if(r)return void O(null,r,e);for(var i in Y.cachedChannels)Y.cachedChannels[i].updateReadReceipt(Ee.getInstance().getCurrentUserId(),n),A(Y.cachedChannels[i],0,0);O(null,null,e)})},this.markAsReadWithChannelUrls=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);var t=(new Date).getTime();if(t-Y.markAsReadAllLastSentAt<1e3)return void O(null,new I("MarkAsRead rate limit exceeded.",te.MARK_AS_READ_RATE_LIMIT_EXCEEDED),n);Y.markAsReadAllLastSentAt=t,le.getInstance().groupChannelMarkAsReadAll(e,function(r,i){if(i)return void O(null,i,n);e.forEach(function(e){var n=Y.cachedChannels[e];n&&(A(n,0,0),n.updateReadReceipt(Ee.getInstance().getCurrentUserId(),t),Y.cachedChannels[e]=n)}),O(null,null,n)})},this.updateCurrentUserInfoWithProfileImage=function(e,n,t){var r=this;n?le.getInstance().updateCurrentUserInfoWithFile(e,n,function(i,a){if(a)return void O(null,a,t);r.currentUser&&(e&&(r.currentUser.nickname=e),n&&(r.currentUser.profileUrl=i.profile_url)),O(r.currentUser,null,t)}):r.updateCurrentUserInfo(e,null,t)},this.updateCurrentUserInfo=function(e,n,t){var r=this;le.getInstance().updateUserInfo(e,n,function(i,a){if(a)return void O(null,a,t);r.currentUser&&(e&&(r.currentUser.nickname=e),n&&(r.currentUser.profileUrl=n)),O(r.currentUser,null,t)})},this.getPendingGCMToken=function(){return this.GCMPushToken},this.getPendingAPNSToken=function(){return this.APNSPushToken},this.registerGCMPushTokenForCurrentUser=function(e,n){var t=this;return e&&"string"==typeof e?this.currentUser?void le.getInstance().registerGCMPushToken(e,function(e,r){if(r)return void O(t.pushTokenRegistrationState.ERROR,r,n);t.GCMPushToken="",O(t.pushTokenRegistrationState.SUCCESS,null,n)}):(t.GCMPushToken=e,void O(t.pushTokenRegistrationState.PENDING,null,n)):void O(t.pushTokenRegistrationState.ERROR,new I("Invalid token",te.INVALID_PARAMETER),n)},this.unregisterGCMPushTokenForCurrentUser=function(e,n){if(!e||"string"!=typeof e)return void O(null,new I("Invalid token",te.INVALID_PARAMETER),n);le.getInstance().unregisterGCMPushToken(e,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.unregisterGCMPushTokenAllForCurrentUser=function(e){le.getInstance().unregisterGCMPushTokenAll(function(n,t){if(t)return void O(null,t,e);O(null,null,e)})},this.registerAPNSPushTokenForCurrentUser=function(e,n){var t=this;return e&&"string"==typeof e?this.currentUser?void le.getInstance().registerAPNSPushToken(e,function(e,r){if(r)return void O(t.pushTokenRegistrationState.ERROR,r,n);t.APNSPushToken="",O(t.pushTokenRegistrationState.SUCCESS,null,n)}):(t.APNSPushToken=e,void O(t.pushTokenRegistrationState.PENDING,null,n)):void O(t.pushTokenRegistrationState.ERROR,new I("Invalid token",te.INVALID_PARAMETER),n)},this.unregisterAPNSPushTokenForCurrentUser=function(e,n){if(!e||"string"!=typeof e)return void O(null,new I("Invalid token",te.INVALID_PARAMETER),n);le.getInstance().unregisterAPNSPushToken(e,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.unregisterAPNSPushTokenAllForCurrentUser=function(e){le.getInstance().unregisterAPNSPushTokenAll(function(n,t){if(t)return void O(null,t,e);O(null,null,e)})},this.unregisterPushTokenAllForCurrentUser=function(e){le.getInstance().unregisterPushTokenAll(function(n,t){if(t)return void O(null,t,e);O(null,null,e)})},this.setDoNotDisturb=function(e,n,t,r,i,a,s){if(n<0||n>23||t<0||t>59||r<0||r>23||i<0||i>59)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),s);le.getInstance().setDoNotDisturb(e,n,t,r,i,a,function(e,n){if(n)return void O(null,n,s);var t={doNotDisturbOn:e.do_not_disturb,startHour:e.start_hour,startMin:e.start_min,endHour:e.end_hour,endMin:e.end_min,timezone:e.timezone};O(t,null,s)})},this.getDoNotDisturb=function(e){le.getInstance().getDoNotDisturb(function(n,t){if(t)return void O(null,t,e);var r={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone};O(r,null,e)})},this.blockUser=function(e,n){if("object"!=typeof e)return void O(null,new I("You have to pass user object.",te.INVALID_PARAMETER),n);this.blockUserWithUserId(e.userId,n)},this.blockUserWithUserId=function(e,n){if(this.getCurrentUserId()===e)return void O(null,new I("You can not block yourself.",te.INVALID_PARAMETER),n);le.getInstance().blockUser(e,function(e,t){if(t)return void O(null,t,n);O(new W(e),null,n)})},this.unblockUser=function(e,n){if("object"!=typeof e)return void O(null,new I("You have to pass user object.",te.INVALID_PARAMETER),n);this.unblockUserWithUserId(e.userId,n)},this.unblockUserWithUserId=function(e,n){if(this.getCurrentUserId()===e)return void O(null,new I("You can not unblock yourself.",te.INVALID_PARAMETER),n);le.getInstance().unblockUser(e,function(e,t){if(t)return void O(null,t,n);O(null,null,n)})},this.addFriends=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().addFriends(e,function(e,t){if(t)return void O(null,t,n);var r=e.users.map(function(e){return new W(e)});O(r,null,n)})},this.deleteFriends=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().deleteFriends(e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.deleteFriend=function(e,n){if("string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.deleteFriends([e],n)},this.uploadFriendDiscoveries=function(e,n){var t=!0;for(var r in e)if(!e[r].hasOwnProperty("friendDiscoveryKey")){t=!1,O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);break}if(t){le.getInstance().uploadFriendDiscoveries(e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})}},this.deleteFriendDiscoveries=function(e,n){if(!Array.isArray(e))return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);le.getInstance().deleteFriendDiscoveries(e,function(e,t){if(t)return void O(null,t,n);O(e,null,n)})},this.deleteFriendDiscovery=function(e,n){if("string"!=typeof e)return void O(null,new I("Invalid parameter.",te.INVALID_PARAMETER),n);this.deleteFriendDiscoveries([e],n)},this.getFriendChangeLogsByToken=function(e,n){if("function"==typeof e&&(n=e,e=null),"function"!=typeof n)return null;le.getInstance().getFriendChangeLogsByToken(e,function(e,t){if(t)return void O(null,t,n);var r=e.updated.map(function(e){return new W(W.build(e.user_id,e.nickname,e.profile_url,e.is_online,e.last_seen_at,e.metadata,e.is_active,e.friend_discovery_key,e.friend_name))}),i=e.deleted,a=e.has_more,s=e.next;O({updatedUsers:r,deletedUserIds:i,hasMore:a,token:s},null,n)})},this.createFriendListQuery=function(){return new ce}},ge=null;return Ee.getInstance=function(){return null===ge?null:ge},{SendBird:Ee}},C=null;return function(){var e=function(e){if(e.newInstance||!C){var n=new v;C=new n.SendBird(e)}else if(C&&e.appId!==C.getApplicationId()&&C.getConnectionState()===C.connectionState.CLOSED){var n=new v;C=new n.SendBird(e)}return C};return e.getInstance=function(){return null===C?null:C},e.version="3.0.77",{SendBird:e}}().SendBird});